(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{107:function(e,t,a){e.exports=a(181)},178:function(e,t,a){},179:function(e,t,a){},180:function(e,t,a){},181:function(e,t,a){"use strict";a.r(t);var n={};a.r(n),a.d(n,"LOGIN",(function(){return T})),a.d(n,"REGISTER",(function(){return R})),a.d(n,"VERIFY",(function(){return S})),a.d(n,"UPDATE_USER_DATA",(function(){return y})),a.d(n,"CLEAN_USER_DATA",(function(){return C})),a.d(n,"LOGOUT",(function(){return _})),a.d(n,"TOKEN",(function(){return I})),a.d(n,"FRIEND_GET",(function(){return k})),a.d(n,"FRIEND_SETNICKNAME",(function(){return A})),a.d(n,"FRIEND_REMOVE",(function(){return w})),a.d(n,"FRIEND_PUSH",(function(){return x})),a.d(n,"FRIEND_POP",(function(){return D})),a.d(n,"FRIEND_SENDFRIENDREQUEST",(function(){return P})),a.d(n,"FRIEND_ACCEPTFRIENDREQUEST",(function(){return F})),a.d(n,"FRIEND_REFUSEFRIENDREQUEST",(function(){return j})),a.d(n,"FRIEND_CANCELFRIENDREQUEST",(function(){return U})),a.d(n,"FRIEND_UPDATE_DATA",(function(){return L})),a.d(n,"FRIENDREQUEST_GET",(function(){return M})),a.d(n,"FRIENDREQUEST_PUSH_RECEVICE",(function(){return G})),a.d(n,"FRIENDREQUEST_PUSH_SENT",(function(){return H})),a.d(n,"FRIENDREQUEST_POP_RECEVICE",(function(){return V})),a.d(n,"FRIENDREQUEST_POP_SENT",(function(){return B})),a.d(n,"CHATROOM_CREATE",(function(){return Q})),a.d(n,"CHATROOM_UNFOLLOW",(function(){return q})),a.d(n,"CHATROOM_INVITE",(function(){return z})),a.d(n,"CHATROOM_GETALLUSERCHATROOMS",(function(){return W})),a.d(n,"CHATROOM_UPDATE",(function(){return K})),a.d(n,"INITIALIZE",(function(){return Y})),a.d(n,"PUSH_TOAST",(function(){return J})),a.d(n,"TOGGLE_SOUND",(function(){return Z})),a.d(n,"SET_VIEW_TYPE",(function(){return $})),a.d(n,"SET_UNREAD_STATE",(function(){return X})),a.d(n,"TOGGLE_NOTIFICATION",(function(){return ee})),a.d(n,"CLOSE_POPUP",(function(){return te})),a.d(n,"OPEN_POPUP",(function(){return ae})),a.d(n,"CLOSE_DIALOG",(function(){return ne})),a.d(n,"OPEN_DIALOG",(function(){return re})),a.d(n,"MESSAGE_GET",(function(){return oe})),a.d(n,"MESSAGE_RECEIVE",(function(){return ce})),a.d(n,"TYPING",(function(){return ie})),a.d(n,"CHOOSE_CONTENT_TAB",(function(){return se})),a.d(n,"CHOOSE_PEOPLE_TAB",(function(){return le})),a.d(n,"NAVIGATOR_SET_CHATROOM",(function(){return ue})),a.d(n,"SET_CONVERSATION_VIEW",(function(){return me}));var r={};a.r(r),a.d(r,"HOST",(function(){return de})),a.d(r,"PORT",(function(){return pe})),a.d(r,"APP_NAME",(function(){return Ee}));var o={};a.r(o),a.d(o,"ELoginViewType",(function(){return s})),a.d(o,"EContentTap",(function(){return l})),a.d(o,"EPeopleTap",(function(){return u})),a.d(o,"EViewType",(function(){return m})),a.d(o,"EConversationType",(function(){return d}));var c={};a.r(c),a.d(c,"responseFormat",(function(){return Te})),a.d(c,"validateEmail",(function(){return Re})),a.d(c,"changeFAVIcon",(function(){return Se}));var i={};a.r(i),a.d(i,"milisecondsToDigital",(function(){return ot})),a.d(i,"milisecondsToTimeString",(function(){return ct})),a.d(i,"roundTime",(function(){return it})),a.d(i,"capitalize",(function(){return st})),a.d(i,"zeroPad",(function(){return lt}));var s,l,u,m,d,p=a(0),E=a.n(p),f=a(21),v=a.n(f),h=a(22),N=a(23),O=a(30),g=a(29),b=a(7),T="LOGIN",R="REGISTER",S="VERIFY",y="UPDATE_USER_DATA",C="CLEAN_USER_DATA",_="LOGOUT",I="TOKEN",k="FRIEND_GET",A="FRIEND_SETNICKNAME",w="FRIEND_REMOVE",x="FRIEND_PUSH",D="FRIEND_POP",P="FRIEND_SENDFRIENDREQUEST",F="FRIEND_ACCEPTFRIENDREQUEST",j="FRIEND_REFUSEFRIENDREQUEST",U="FRIEND_CANCELFRIENDREQUEST",L="FRIEND_UPDATE_DATA",M="FRIENDREQUEST_GET",G="FRIENDREQUEST_PUSH_RECEVICE",H="FRIENDREQUEST_PUSH_SENT",V="FRIENDREQUEST_POP_RECEVICE",B="FRIENDREQUEST_POP_SENT",Q="CHATROOM_CREATE",q="CHATROOM_UNFOLLOW",z="CHATROOM_INVITE",W="CHATROOM_GETALLUSERCHATROOMS",K="CHATROOM_UPDATE",Y="INITIALIZE",J="PUSH_TOAST",Z="TOGGLE_SOUND",$="SET_VIEW_TYPE",X="SET_UNREAD_STATE",ee="TOGGLE_NOTIFICATION",te="CLOSE_POPUP",ae="OPEN_POPUP",ne="CLOSE_DIALOG",re="OPEN_DIALOG",oe="MESSAGE_GET",ce="MESSAGE_RECEIVE",ie="TYPING",se="CHOOSE_CONTENT_TAB",le="CHOOSE_PEOPLE_TAB",ue="NAVIGATOR_SET_CHATROOM",me="SET_CONVERSATION_VIEW",de="127.0.0.1",pe=3e3,Ee="Messenger";!function(e){e.SIGNIN="SIGNIN",e.SIGNUP="SIGNUP"}(s||(s={})),function(e){e.CONVERSATION="CHAT",e.PEOPLE="PEOPLE"}(l||(l={})),function(e){e.PEOPLE="PEOPLE",e.REQUEST="REQUEST"}(u||(u={})),function(e){e.WINDOW="WINDOW",e.MOBILE="MOBILE"}(m||(m={})),function(e){e.NORMAL="NORMAL",e.ARCHIVE="ARCHIVE",e.BLOCK="BLOCK"}(d||(d={}));var fe={event:{USER:{GET:"get"},PROFILE:{GET:"get",PUT:"put",REMOVE:"remove"},FRIEND:{GET:"get",SETNICKNAME:"setNickName",REMOVE:"remove",GETFRIENDREQUEST:"getFriendRequest",SENDFRIENDREQUEST:"sendFriendRequest",ACCEPTFRIENDREQUEST:"acceptFriendRequest",REFUSEFRIENDREQUEST:"refuseFriendRequest",CANCELFRIENDREQUEST:"cancelFriendRequest",RECEIVEFRIENDREQUEST:"receiveFriendRequest",REMOVEFRIENDREQUEST:"removeFriendRequest",ONACCEPTFRIENDREQUEST:"onAcceptFriendRequest",ONREMOVEFRIEND:"onRemoveFriend"},CHATROOM:{CREATE:"create",UNFOLLOW:"unfollow",INVITE:"invite",GETALLUSERCHATROOMS:"getAllUserChatrooms",MASK_AS_READ:"maskAsRead",MASK_AS_UNREAD:"maskAsUnread",SET_ARCHIVE:"setArchive",SET_BLOCK:"setBlock",SEND_TYPING:"sendTyping",UPDATE:"update"},MESSAGE:{GET:"get",SEND:"send",RECEIVE:"receive"}},packet:{AUTH:"AUTH",PROFILE:"PROFILE",USER:"USER",FRIEND:"FRIEND",CHATROOM:"CHATROOM",MESSAGE:"MESSAGE",FRIEND_UPDATE_DATA:"FRIEND_UPDATE_DATA"},action:n,config:r,type:o},ve=a(196),he=a(1),Ne=a.n(he),Oe=a(8),ge=a(35),be=a.n(ge);function Te(e){return(null===e||void 0===e?void 0:e.data)||{success:!1,status:void 0,data:void 0}}function Re(e){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).toLowerCase())}function Se(e){var t=document.head||document.getElementsByTagName("head")[0],a=document.createElement("link"),n=document.getElementById("dynamic-favicon");a.id="dynamic-favicon",a.rel="shortcut icon",a.href=e,n&&t.removeChild(n),t.appendChild(a)}var ye="http://".concat(fe.config.HOST,":").concat(fe.config.PORT),Ce={};function _e(e){Ce=Object.assign(Ce,e)}function Ie(){return Ce}function ke(e){return Ae.apply(this,arguments)}function Ae(){return(Ae=Object(Oe.a)(Ne.a.mark((function e(t){var a,n,r;return Ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be.a.post("".concat(ye,"/auth/register"),t,{headers:Ce});case 2:return a=e.sent,(n=Te(a)).success&&(r=n.data.authorization,Ce=Object.assign(Ce,{authorization:"Bearer ".concat(r)}),localStorage.setItem("socketcluster.authToken",r)),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function we(e,t){return xe.apply(this,arguments)}function xe(){return(xe=Object(Oe.a)(Ne.a.mark((function e(t,a){var n,r,o;return Ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be.a.post("".concat(ye,"/auth/login"),{email:t,password:a},{headers:Ce});case 2:return n=e.sent,(r=Te(n)).success&&(o=r.data.authorization,Ce=Object.assign(Ce,{authorization:"Bearer ".concat(o)}),localStorage.setItem("socketcluster.authToken",o)),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function De(){return Pe.apply(this,arguments)}function Pe(){return(Pe=Object(Oe.a)(Ne.a.mark((function e(){var t,a;return Ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be.a.post("".concat(ye,"/auth/token"),{},{headers:Ce});case 2:return t=e.sent,(a=Te(t)).success||(Ce=Object.assign(Ce,{authorization:""})),e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Fe(e){return je.apply(this,arguments)}function je(){return(je=Object(Oe.a)(Ne.a.mark((function e(t){var a;return Ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be.a.post("".concat(ye,"/auth/verify"),{uuid:t},{headers:Ce});case 2:return a=e.sent,e.abrupt("return",Te(a));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ue(){return Le.apply(this,arguments)}function Le(){return(Le=Object(Oe.a)(Ne.a.mark((function e(){var t;return Ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be.a.post("".concat(ye,"/auth/resendVerify"),{},{headers:Ce});case 2:return t=e.sent,e.abrupt("return",Te(t));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Me(){return Ge.apply(this,arguments)}function Ge(){return(Ge=Object(Oe.a)(Ne.a.mark((function e(){var t,a;return Ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be.a.post("".concat(ye,"/auth/logout"),{},{headers:Ce});case 2:return t=e.sent,(a=Te(t)).success&&(Ce=Object.assign(Ce,{authorization:""}),localStorage.removeItem("socketcluster.authToken")),e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function He(e){return Ve.apply(this,arguments)}function Ve(){return(Ve=Object(Oe.a)(Ne.a.mark((function e(t){var a,n;return Ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be.a.post("".concat(ye,"/upload/avatar"),t,{headers:Ce});case 2:return a=e.sent,n=Te(a),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Be(e){return{type:fe.action.PUSH_TOAST,payload:e}}function Qe(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{type:fe.action.CLOSE_POPUP,payload:e}}function qe(e){return{type:fe.action.OPEN_POPUP,payload:e}}function ze(e,t){return{type:fe.action.OPEN_DIALOG,payload:{content:e,position:t}}}var We=a(10),Ke=a(12),Ye=a(94),Je=a.n(Ye),Ze=function(){function e(){Object(h.a)(this,e),this.socket=void 0}return Object(N.a)(e,[{key:"getSocket",value:function(){return this.socket}},{key:"init",value:function(e){var t=e.deviceId,a=Je.a.create({hostname:fe.config.HOST,port:fe.config.PORT,query:{deviceId:t}});this.socket=a,window.socket=this,a.listener("connect").once().then((function(e){var t=e.id,a=e.isAuthenticated;console.log("%cSocket","color: #2e7d32","connect",t,a)})),a.listener("disconnect").once().then((function(e){var t=e.reason;console.log("%cSocket","color: #2e7d32","disconnect",t),a.closeAllChannels()})),a.listener("removeAuthToken").once().then((function(e){var t=e.oldAuthToken;console.log("%cSocket","color: #2e7d32","removeAuthToken",t)})),a.listener("connecting").once().then((function(){console.log("%cSocket","color: #2e7d32","connecting")})),a.listener("authStateChange").once().then((function(e){console.log("%cSocket","color: #2e7d32","authStateChange")})),a.listener("authenticate").once().then((function(e){var t=e.authToken,a=e.signedAuthToken;console.log("%cSocket","color: #2e7d32","authenticate",t,a)})),a.listener("deauthenticate").once().then((function(e){var t=e.oldAuthToken,a=e.oldSignedAuthToken;console.log("%cSocket","color: #2e7d32","deauthenticate",t,a)})),a.listener("error").once().then((function(e){var t=e.error;console.log("%cSocket","color: #2e7d32","error",t)})),a.listener("connectAbort").once().then((function(e){var t=e.code,a=e.reason;console.log("%cSocket","color: #2e7d32","connectAbort",t,a)})),a.listener("subscribeStateChange").once().then((function(e){var t=e.channel,a=e.newChannelState,n=e.oldChannelState,r=e.subscriptionOptions;console.log("%cSocket","color: #2e7d32","subscribeStateChange",t,a,n,r)})),a.listener("subscribe").once().then((function(e){var t=e.channel,a=e.subscriptionOptions;console.log("%cSocket","color: #2e7d32","subscribe",t,a)})),a.listener("subscribeFail").once().then((function(e){var t=e.channel,a=e.error,n=e.subscriptionOptions;console.log("%cSocket","color: #2e7d32","subscribeFail",t,a,n)})),a.listener("unsubscribe").once().then((function(e){var t=e.channel;console.log("%cSocket","color: #2e7d32","unsubscribe",t)})),a.listener("kickOut").once().then((function(e){var t=e.channel,a=e.message;console.log("%cSocket","color: #2e7d32","kickOut",t,a)}))}}],[{key:"ins",value:function(){return this.instance||(this.instance=new e),this.instance}}]),e}();Ze.instance=void 0;var $e=Ze.ins();var Xe=a(14),et=a(38);function tt(e){return function(){var t=Object(Oe.a)(Ne.a.mark((function t(a){return Ne.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a({type:fe.action.CHOOSE_CONTENT_TAB,payload:e});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}function at(e){return function(){var t=Object(Oe.a)(Ne.a.mark((function t(a){return Ne.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a({type:fe.action.CHOOSE_PEOPLE_TAB,payload:e});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}function nt(e){return function(){var t=Object(Oe.a)(Ne.a.mark((function t(a){return Ne.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a({type:fe.action.NAVIGATOR_SET_CHATROOM,payload:e});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}var rt=a(188);function ot(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"hh:mm:ss:ms",a=e%1e3/100,n=Math.floor(e/1e3%60),r=Math.floor(e/6e4%60),o=Math.floor(e/36e5%24);return t=(t=(t=(t=t.replace("hh","".concat(o<10?"0"+o:o))).replace("mm","".concat(r<10?"0"+r:r))).replace("ss","".concat(n<10?"0"+n:n))).replace("ms","".concat(a))}function ct(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"hh:mm:ss:ms";if(e<500)return"Just now";var a=e%1e3/100,n=Math.floor(e/1e3%60),r=Math.floor(e/6e4%60),o=Math.floor(e/36e5%24);return(t=(t=(t=(t=(t=t.replace(/:/g," ")).replace("hh","".concat(o>0?"".concat(o," ").concat(o<=1?"hour":"hours"):""))).replace("mm","".concat(n>0?"".concat(n," ").concat(n<=1?"second":"seconds"):""))).replace("ss","".concat(r>0?"".concat(r," ").concat(r<=1?"minute":"minutes"):""))).replace("ms","".concat(a>0?"".concat(a," ").concat(a<=1?"millisecond":"milliseconds"):""))).trim()}function it(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=Math.floor(e/864e5);if(a)return"".concat(a).concat(t?a>1?" days":" day":"d");var n=Math.floor(e/36e5);if(n)return"".concat(n).concat(t?a>1?" hours":" hour":"h");var r=Math.floor(e/6e4);if(r)return"".concat(r).concat(t?a>1?" minutes":" minute":"m");var o=Math.floor(e/1e3);return o?"".concat(o).concat(t?a>1?" seconds":" second":"s"):"0s"}function st(e){return e.split(" ").map((function(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()})).join(" ")}function lt(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";a=a||"0";var n=e.toString();return n.length>=t?n:new Array(t-n.length+1).join(a)+n}var ut={common:c,string:i};function mt(e){var t=e.url,a=e.online,n=e.size,r=e.className,o=e.onClick;return E.a.createElement("div",{className:"avatar ".concat(r),onClick:function(){"function"===typeof o&&o()},style:{cursor:"function"===typeof o?"pointer":"initial"}},E.a.createElement("div",{className:"wrap ".concat(n)},E.a.createElement("div",{className:"img-wrap"},t?E.a.createElement("img",{src:"http://".concat(fe.config.HOST,":").concat(fe.config.PORT,"/").concat(t),alt:"",height:"100%"}):E.a.createElement("i",{className:"fa fa-user"})),a?a.status?E.a.createElement("div",{className:"online-status"}):E.a.createElement(rt.a,{variant:"pill dark text-bolder"},ut.string.roundTime(Date.now()-new Date(a.lastOnlineTime).getTime())):E.a.createElement(E.a.Fragment,null)))}var dt=a(189),pt=a(95),Et=a(199);var ft=Object(b.b)(null,{closePopup:Qe})((function(e){var t=e.content,a=e.buttons,n=e.closePopup;return E.a.createElement("div",{className:"popup_confirm"},E.a.createElement("div",{className:"popup_content text-normal mb-4"},t),E.a.createElement("div",{className:"popup_control"},a.map((function(e,t){return E.a.createElement(Et.a,{variant:e.primary?"primary":"light",onClick:function(){e.func&&e.func(),n()},className:"".concat(e.primary?"":"text-primary"," text-bold"),key:t},e.title)}))))})),vt=void 0;var ht=Object(b.b)((function(e){var t=e.friend,a=e.friendRequest;return{user:e.user,friend:t,friendRequest:a,chatroom:e.chatroom}}),{openPopup:qe,closePopup:Qe,chooseContentTab:tt,setChatroomNavigation:nt})((function(e){var t=e.data,a=e.friend,n=e.friendRequest,r=e.user,o=e.chatroom,c=e.form,i=e.openPopup,s=e.closePopup,l=e.chooseContentTab,u=e.setChatroomNavigation,m=t.lastName,d=t.email,p=t.firstName,f=t.avatar,v=t._id,h=t.nickname,N=t.online,O=t.lastOnlineTime,g=n.sent.find((function(e){return e.from._id===r._id&&e.to._id===t._id}));return E.a.createElement("div",{className:"popup_user_info"},E.a.createElement(mt,{url:f,size:"langer",className:"mb-2",online:{status:N,lastOnlineTime:O}}),E.a.createElement("div",{className:"text-normal text-13"},d),E.a.createElement("div",{className:"d-flex align-items-center flex-column mb-4"},E.a.createElement("div",{className:"text-normal text-30"},"".concat(m," ").concat(p)),E.a.createElement("div",{className:"nickname align-items-center ".concat("friend"!==c||a.every((function(e){return e._id!==v}))?"d-none":"d-flex")},E.a.createElement(dt.a,{className:"mb-3"},E.a.createElement(pt.a,{placeholder:"Nickname",defaultValue:h,"aria-label":"Nickname","aria-describedby":"basic-addon1",onChange:function(e){var t=e.target.value,a=$e.getSocket();vt&&clearTimeout(vt),vt=setTimeout((function(){vt&&clearTimeout(vt),"string"===typeof t&&a&&a.transmit(fe.packet.FRIEND,{evt:fe.event.FRIEND.SETNICKNAME,data:{friendId:v,nickname:t}})}),400)}}),E.a.createElement(dt.a.Append,null,E.a.createElement(dt.a.Text,{id:"basic-addon1"},E.a.createElement("i",{className:"fa fa-pencil"})))))),E.a.createElement("div",{className:"control-area"},E.a.createElement(Et.a,{variant:"outline-primary",onClick:function(){l(fe.type.EContentTap.CONVERSATION),s();var e=o.find((function(e){return"conversation"===e.chatroom.type&&1===e.friendsChatroom.length&&e.friendsChatroom[0]._id===v}));if(e)u(e.chatroom._id);else{var t=$e.getSocket();t&&t.transmit(fe.packet.CHATROOM,{evt:fe.event.CHATROOM.CREATE,data:{users:[v],type:"conversation"}})}}},E.a.createElement("i",{className:"fa fa-comment"})),a.every((function(e){return e._id!==v}))?E.a.createElement(Et.a,{variant:g?"outline-danger":"outline-primary",onClick:g?function(){var e=$e.getSocket();e&&g&&e.transmit(fe.packet.FRIEND,{evt:fe.event.FRIEND.CANCELFRIENDREQUEST,data:{requestId:g._id}})}:function(){var e=$e.getSocket();e&&e.transmit(fe.packet.FRIEND,{evt:fe.event.FRIEND.SENDFRIENDREQUEST,data:{userId:v}})}},g?E.a.createElement("i",{className:"fa fa-user-times"}):E.a.createElement("i",{className:"fa fa-user-plus"})):E.a.createElement(Et.a,{variant:"outline-danger",onClick:function(){i({body:E.a.createElement(ft,{content:"Are you sure you want to remove ".concat(m," ").concat(p," from your friends list?"),buttons:[{title:"Ok",primary:!0,func:function(){var e=$e.getSocket();e&&e.transmit(fe.packet.FRIEND,{evt:fe.event.FRIEND.REMOVE,data:{friendId:v}})}},{title:"Cancel"}]})})}},E.a.createElement("i",{className:"fa fa-trash"}))))}));var Nt=Object(b.b)((function(e){return{navigation:e.navigation,chatroom:e.chatroom,friend:e.friend}}),{setChatroomNavigation:nt,openPopup:qe})((function(e){var t,a,n,r,o,c,i,s,l,u,m,d,p,f,v=e.chatroom,h=e.navigation,N=e.friend,O=e.setChatroomNavigation,g=e.openPopup,b=h.chatroom,T=v.find((function(e){return e.chatroom._id===b}));if(!T)return E.a.createElement(E.a.Fragment,null);var R=T.friendsChatroom,S=T.friendsChatroom.map((function(e){return N.find((function(t){return t._id===e.user._id}))})),y="conversation"===T.chatroom.type?S.length>0&&(null===(t=S[0])||void 0===t?void 0:t.nickname)?null===(a=S[0])||void 0===a?void 0:a.nickname:"".concat(null===(n=R[0])||void 0===n||null===(r=n.user)||void 0===r?void 0:r.lastName," ").concat(null===(o=R[0])||void 0===o||null===(c=o.user)||void 0===c?void 0:c.firstName):T.chatroom.name,C="conversation"===T.chatroom.type&&R.length>0&&(null===(i=R[0])||void 0===i||null===(s=i.user)||void 0===s?void 0:s.online)?"Online":(null===(l=R[0])||void 0===l||null===(u=l.user)||void 0===u?void 0:u.lastOnlineTime)?"Active ".concat(ut.string.roundTime(Date.now()-new Date(null===(m=R[0])||void 0===m||null===(d=m.user)||void 0===d?void 0:d.lastOnlineTime).getTime(),!0)," ago"):"",_="conversation"===T.chatroom.type&&R.length>0?null===(p=R[0])||void 0===p||null===(f=p.user)||void 0===f?void 0:f.avatar:void 0;return E.a.createElement("div",{className:"info-area px-3 py-2"},E.a.createElement("div",{className:"d-flex"},E.a.createElement("button",{className:"pr-3 d-sm-none",onClick:function(){O(void 0)}},E.a.createElement("i",{className:"fa fa-chevron-left font-weight-light text-primary"})),E.a.createElement(mt,{url:_,size:"normal",onClick:function(){var e,t;T&&"conversation"===T.chatroom.type&&R.length>0&&(null===(e=R[0])||void 0===e?void 0:e.user)&&g({body:E.a.createElement(ht,{data:null===(t=R[0])||void 0===t?void 0:t.user,form:"friend"})})}}),E.a.createElement("div",{className:"user-info ml-3"},E.a.createElement("p",{className:"text-bold text-16"},y),E.a.createElement("p",{className:"text-normal text-light text-12"},C))),E.a.createElement("div",{className:"control d-flex align-items-center"}))})),Ot=a(195);var gt=Object(b.b)((function(e){return{navigation:e.navigation,chatroom:e.chatroom}}))((function(e){var t=e.chatroom,a=e.navigation,n=Object(p.useState)(!1),r=Object(We.a)(n,2),o=r[0],c=r[1],i=Object(p.useState)(""),s=Object(We.a)(i,2),l=s[0],u=s[1],m=a.chatroom,d=t.find((function(e){return e.chatroom._id===m}));if(!d)return E.a.createElement(E.a.Fragment,null);var f=function(e){var t=$e.getSocket();t&&t.transmit(fe.packet.CHATROOM,{evt:fe.event.CHATROOM.SEND_TYPING,data:{typing:e,chatroomId:m}})},v=function(){if(d&&!(null===d||void 0===d?void 0:d.myChatroom.read)){var e=$e.getSocket();e&&e.transmit(fe.packet.CHATROOM,{evt:fe.event.CHATROOM.MASK_AS_READ,data:{userChatroomId:d.myChatroom._id}})}},h=function(e){if(e.preventDefault(),"string"===typeof l&&l.length){u("");var t=$e.getSocket();t&&(t.transmit(fe.packet.MESSAGE,{evt:fe.event.MESSAGE.SEND,data:{text:l,chatroomId:m}}),c(!1),f(!1))}};return E.a.createElement(Ot.a,{className:"control-area px-3 py-2",onSubmit:h},E.a.createElement(dt.a,null,E.a.createElement(pt.a,{placeholder:"Enter your message...","aria-label":"Enter your message...",value:l,"aria-describedby":"basic-addon1",onChange:function(e){var t=e.target.value;u(t),v(),!o&&t?(c(!0),f(!0)):o&&!t&&(c(!1),f(!1))},onFocus:function(){v()},onBlur:function(){o&&(c(!1),f(!1))}}),E.a.createElement(dt.a.Append,null,E.a.createElement(dt.a.Text,{id:"basic-addon1"}))),E.a.createElement(Et.a,{className:"ml-2 btn-circle",onClick:h},E.a.createElement("i",{className:"fa fa-paper-plane"})))})),bt=a(190),Tt=void 0;function Rt(e){var t,a,n,r,o,c,i,s,l=e.data,u=e.preData,m=e.nextData,d=e.user,p=l.user._id===d._id,f=(null===(t=null===m||void 0===m?void 0:m.user)||void 0===t?void 0:t._id)===l.user._id&&(null===(a=null===u||void 0===u?void 0:u.user)||void 0===a?void 0:a._id)===l.user._id,v=(null===(n=null===m||void 0===m?void 0:m.user)||void 0===n?void 0:n._id)===l.user._id&&(null===(r=null===u||void 0===u?void 0:u.user)||void 0===r?void 0:r._id)!==l.user._id,h=(null===(o=null===m||void 0===m?void 0:m.user)||void 0===o?void 0:o._id)!==l.user._id&&(null===(c=null===u||void 0===u?void 0:u.user)||void 0===c?void 0:c._id)===l.user._id,N=(null===(i=null===m||void 0===m?void 0:m.user)||void 0===i?void 0:i._id)!==l.user._id&&(null===(s=null===u||void 0===u?void 0:u.user)||void 0===s?void 0:s._id)!==l.user._id;return E.a.createElement("div",{className:"\n            item-chat-message \n            px-3 \n            ".concat(p?"mine":"friend"," \n            ").concat(v||N?"mb-3":"","\n            ")},E.a.createElement(mt,{url:l.user.avatar,size:"small",className:"".concat(p||!v&&!N?"invisible":"visible"," mr-2")}),E.a.createElement("div",{className:"message-text text-normal text-15 ".concat(f?"chat-mid":v?"chat-end":h?"chat-top":"")},l.message))}var St=Object(b.b)((function(e){return{typing:e.typing,navigation:e.navigation,user:e.user}}))((function(e){var t,a=e.typing,n=e.navigation,r=e.user,o=n.chatroom,c=o?a[o]:void 0,i=c&&c.some((function(e){return e._id!==r._id})),s=c&&(null===(t=c.find((function(e){return e._id!==r._id})))||void 0===t?void 0:t.avatar);return E.a.createElement("div",{className:"item-chat-message px-3 friend mb-3 ".concat(i?"d-flex":"d-none")},E.a.createElement(mt,{url:s,size:"small",className:"visible mr-2"}),E.a.createElement("div",null,E.a.createElement("div",{className:"dotsContainer"},E.a.createElement("span",{id:"dot1"}),E.a.createElement("span",{id:"dot2"}),E.a.createElement("span",{id:"dot3"}))))})),yt=Object(b.b)((function(e){return{navigation:e.navigation,chatroom:e.chatroom,message:e.message,user:e.user}}))((function(e){var t=e.chatroom,a=e.navigation,n=e.message,r=e.user,o=Object(p.useState)(0),c=Object(We.a)(o,2),i=(c[0],c[1]),s=Object(p.useState)(!1),l=Object(We.a)(s,2),u=l[0],m=l[1];window.addEventListener("resize",(function(){Tt&&(clearTimeout(Tt),Tt=void 0),Tt=setTimeout((function(){Tt&&(clearTimeout(Tt),Tt=void 0),i(Math.random())}),100)}));var d=window.innerHeight-57-50;Object(p.useEffect)((function(){var e=document.getElementById("chat-area");e&&e.addEventListener("scroll",(function(e){var t=e.target.scrollTop;if("number"===typeof t&&0===t&&!u){m(!0);var n=$e.getSocket();n&&n.transmit(fe.packet.MESSAGE,{evt:fe.event.MESSAGE.GET,data:{chatroomId:a.chatroom,skip:v.length}}),setTimeout((function(){m(!1)}),1e3)}}))}));var f=a.chatroom;if(!t.find((function(e){return e.chatroom._id===f})))return E.a.createElement("div",{className:"d-flex w-100 h-100 justify-content-center align-items-center text-20"},"Let's start your first conversation");var v=[];if(f&&n[f])v=n[f];else{var h=$e.getSocket();h&&h.transmit(fe.packet.MESSAGE,{evt:fe.event.MESSAGE.GET,data:{chatroomId:f}})}return E.a.createElement("div",{className:"chat-area",id:"chat-area",style:{height:d}},E.a.createElement(St,null),v.map((function(e,t){return E.a.createElement(Rt,{data:e,preData:v[t-1],nextData:v[t+1],user:r,key:t})})),E.a.createElement("div",{className:"justify-content-center py-2 ".concat(u?"d-flex":"d-none")},E.a.createElement(bt.a,{animation:"border"})))})),Ct=function(e){Object(O.a)(a,e);var t=Object(g.a)(a);function a(){return Object(h.a)(this,a),t.apply(this,arguments)}return Object(N.a)(a,[{key:"render",value:function(){return E.a.createElement("div",{className:"content-chat"},E.a.createElement(Nt,null),E.a.createElement(yt,null),E.a.createElement(gt,null))}}]),a}(p.Component),_t=void 0;function It(){var e=Object(p.useState)([]),t=Object(We.a)(e,2),a=t[0],n=t[1],r=Object(p.useState)(!1),o=Object(We.a)(r,2),c=o[0],i=o[1];return E.a.createElement("div",{className:"popup_search_user"},E.a.createElement(dt.a,{className:"mb-1"},E.a.createElement(dt.a.Prepend,null,E.a.createElement(dt.a.Text,{id:"basic-addon1"},E.a.createElement("i",{className:"fa fa-search"}))),E.a.createElement(pt.a,{placeholder:"Find on message","aria-label":"Username","aria-describedby":"basic-addon1",onChange:function(e){var t=e.target.value,a=$e.getSocket();_t&&clearTimeout(_t),c||i(!0),_t=setTimeout((function(){_t&&clearTimeout(_t),t&&a&&a.invoke(fe.packet.USER,{evt:fe.event.USER.GET,data:{string:t}}).then((function(e){n(e)})),i(!1)}),300)}}),E.a.createElement(dt.a.Append,null,E.a.createElement(dt.a.Text,{id:"basic-addon1"},c?E.a.createElement(bt.a,{size:"sm",animation:"border"}):E.a.createElement(E.a.Fragment,null)))),E.a.createElement("div",{className:"popup-content"},a.map((function(e,t){return E.a.createElement(kt,{data:e,key:t})}))))}var kt=Object(b.b)(null,{openPopup:qe})((function(e){var t=e.data,a=e.openPopup,n=t.lastName,r=t.firstName,o=t.avatar,c=t.email;return E.a.createElement("div",{className:"popup-item px-3 pb-1",style:{cursor:"pointer"},onClick:function(){a({body:E.a.createElement(ht,{data:t}),openRecent:!0})}},E.a.createElement(mt,{url:o,size:"normal"}),E.a.createElement("div",{className:"popup-item-name"},E.a.createElement("p",{className:"text-normal text-18"},"".concat(n," ").concat(r)),E.a.createElement("p",{className:"text-normal text-11"},c)))}));var At=Object(b.b)((function(e){return{user:e.user,app:e.app}}),{toggleNotification:function(e){return localStorage.setItem("notification",JSON.stringify(e)),{type:fe.action.TOGGLE_NOTIFICATION,payload:e}},toggleSound:function(e){return localStorage.setItem("sound",JSON.stringify(e)),{type:fe.action.TOGGLE_SOUND,payload:e}}})((function(e){var t=e.user,a=e.app,n=e.toggleNotification,r=e.toggleSound,o=t.avatar,c=t.firstName,i=t.lastName,s=a.sound,l=a.notification;return E.a.createElement("div",{className:"popup_setting"},E.a.createElement("div",{className:"popup_item"},E.a.createElement("div",{className:"popup_item_title"},"Account"),E.a.createElement("div",{className:"popup_item_content"},E.a.createElement(mt,{size:"small",url:o,className:"mr-3"}),E.a.createElement("p",null,"".concat(i," ").concat(c)))),E.a.createElement("div",{className:"popup_item"},E.a.createElement("div",{className:"popup_item_title"},"Sound"),E.a.createElement("div",{className:"popup_item_content"},E.a.createElement(Ot.a,null,E.a.createElement(Ot.a.Check,{type:"switch",id:"sound-switch",label:"",defaultChecked:s,onChange:function(){r(!s)}})))),E.a.createElement("div",{className:"popup_item"},E.a.createElement("div",{className:"popup_item_title"},"Notification"),E.a.createElement("div",{className:"popup_item_content"},E.a.createElement(Ot.a,null,E.a.createElement(Ot.a.Check,{type:"switch",id:"notification-switch",label:"",defaultChecked:l,onChange:function(){n(!l)}})))))}));var wt=Object(b.b)(null,{logout:function(){return function(){var e=Object(Oe.a)(Ne.a.mark((function e(t){var a,n;return Ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Me();case 2:(a=e.sent).success?(null===(n=$e.socket)||void 0===n||n.disconnect(),t({type:fe.action.LOGOUT})):console.log(a.message);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},openPopup:qe,setConversationViewType:function(e){return function(){var t=Object(Oe.a)(Ne.a.mark((function t(a){return Ne.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a({type:fe.action.SET_CONVERSATION_VIEW,payload:e});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}})((function(e){var t=e.logout,a=e.openPopup,n=e.setConversationViewType;return E.a.createElement("div",{className:"setting_drop_content drop_content"},E.a.createElement(Et.a,{variant:"outline-secondary drop_item",onClick:function(){a({header:{title:"Setting",btnRight:{title:"Done"}},body:E.a.createElement(At,null)})}},"Setting"),E.a.createElement("div",{className:"drop_seperate"}),E.a.createElement(Et.a,{variant:"outline-secondary drop_item",onClick:function(){n(d.NORMAL)}},"Chat message"),E.a.createElement(Et.a,{variant:"outline-secondary drop_item",onClick:function(){n(d.ARCHIVE)}},"Archive message"),E.a.createElement(Et.a,{variant:"outline-secondary drop_item",onClick:function(){n(d.BLOCK)}},"Block message"),E.a.createElement("div",{className:"drop_seperate"}),E.a.createElement(Et.a,{variant:"outline-secondary drop_item"},"About"),E.a.createElement(Et.a,{variant:"outline-secondary drop_item"},"Rule"),E.a.createElement(Et.a,{variant:"outline-secondary drop_item"},"Privacy policy"),E.a.createElement(Et.a,{variant:"outline-secondary drop_item"},"Cookie policy"),E.a.createElement("div",{className:"drop_seperate"}),E.a.createElement(Et.a,{variant:"outline-secondary drop_item"},"Help"),E.a.createElement(Et.a,{variant:"outline-secondary drop_item"},"Report problem"),E.a.createElement("div",{className:"drop_seperate"}),E.a.createElement(Et.a,{variant:"outline-secondary drop_item",onClick:function(){t()}},"Logout"))}));var xt=Object(b.b)((function(e){return{user:e.user}}),{updateUserData:function(e){return{type:fe.action.UPDATE_USER_DATA,payload:e}},pushToast:Be,closePopup:Qe})((function(e){var t=e.user,a=e.updateUserData,n=e.pushToast,r=e.closePopup,o=Object(p.useState)("view"),c=Object(We.a)(o,2),i=c[0],s=c[1],l=Object(p.useState)(!1),u=Object(We.a)(l,2),m=u[0],d=u[1],f=Object(p.useState)(!1),v=Object(We.a)(f,2),h=v[0],N=v[1],O=Object(p.useState)(""),g=Object(We.a)(O,2),b=g[0],T=g[1],R=Object(p.useState)(void 0),S=Object(We.a)(R,2),y=S[0],C=S[1],_=Object(p.useState)(t.firstName),I=Object(We.a)(_,2),k=I[0],A=I[1],w=Object(p.useState)(t.lastName),x=Object(We.a)(w,2),D=x[0],P=x[1],F=Object(p.useState)(""),j=Object(We.a)(F,2),U=j[0],L=j[1],M=Object(p.useState)(""),G=Object(We.a)(M,2),H=G[0],V=G[1],B=Object(p.useState)(""),Q=Object(We.a)(B,2),q=Q[0],z=Q[1],W=function(){s("view"),L(""),V(""),z(""),d(!1)},K=function(){var e=Object(Oe.a)(Ne.a.mark((function e(){var t,o,c,l,u;return Ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=$e.getSocket()){e.next=3;break}return e.abrupt("return",s("view"));case 3:if("changePassword"!==i){e.next=7;break}U===H?t.invoke(fe.packet.PROFILE,{evt:fe.event.PROFILE.PUT,data:{oldPassword:q,password:U}}).then((function(e){n({content:e.message,time:new Date}),a(e.data),W(),r()})).catch((function(e){n({content:"Edit profile error",time:new Date}),d(!0)})):d(!0),e.next=27;break;case 7:if("editData"!==i){e.next=26;break}if(o="",!y){e.next=21;break}return(c=new FormData).append("file",y),e.next=14,He(c);case 14:if(!(l=e.sent).success){e.next=19;break}o=l.data,e.next=21;break;case 19:return d(!0),e.abrupt("return");case 21:u={oldPassword:q,firstName:k,lastName:D},o&&(u.avatar=o),t.invoke(fe.packet.PROFILE,{evt:fe.event.PROFILE.PUT,data:u}).then((function(e){n({content:e.message,time:new Date}),a(e.data),W()})).catch((function(e){n({content:"Edit profile error",time:new Date}),d(!0)})),e.next=27;break;case 26:s("view");case 27:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return E.a.createElement("div",{className:"popup_profile"},E.a.createElement("div",{className:"d-flex justify-content-center mb-1 position-relative"},E.a.createElement(mt,{url:t.avatar,size:"langer",className:"".concat("editData"!==i?"d-inline-flex":"d-none")}),E.a.createElement("div",{className:"".concat("editData"===i?"avatar":"d-none")},E.a.createElement("div",{className:"wrap langer"},t.avatar||b?E.a.createElement("img",{src:b||"http://".concat(fe.config.HOST,":").concat(fe.config.PORT,"/").concat(t.avatar),alt:"",height:"100%"}):E.a.createElement("div",null),E.a.createElement("div",{className:"avatar-form ".concat(h||!t.avatar&&!b?"drag-enter":"")},E.a.createElement("span",{className:"file-msg"},E.a.createElement("i",{className:"fa fa-plus"})),E.a.createElement("input",{className:"file-input",type:"file",multiple:!0,onDragEnter:function(e){N(!0)},onDragLeave:function(e){N(!1)},onChange:function(e){var t;N(!1);var a=null===(t=e.target.files)||void 0===t?void 0:t[0];if(a){var n=new FileReader;n.readAsDataURL(a),n.onload=function(e){var t;C(a),T(null===(t=e.target)||void 0===t?void 0:t.result)}}}})))),E.a.createElement("button",{className:"position-absolute text-18 ".concat("view"===i?"d-none":"d-block"),style:{left:"0px"},onClick:function(){W()}},E.a.createElement("i",{className:"fa fa-chevron-left font-weight-light"}))),E.a.createElement("div",{className:"mb-3 text-center"},t.email),E.a.createElement(dt.a,{className:"mb-3 ".concat("editData"===i||"view"===i?"d-flex":"d-none")},E.a.createElement(pt.a,{placeholder:"Lastname","aria-label":"Lastname",className:"text-bold ".concat("view"!==i&&m?"wrong":""),value:D,readOnly:"view"===i,onChange:function(e){P(e.target.value)}})),E.a.createElement(dt.a,{className:"mb-3 ".concat("editData"===i||"view"===i?"d-flex":"d-none")},E.a.createElement(pt.a,{placeholder:"Firstname","aria-label":"Firstname",className:"text-bold ".concat("view"!==i&&m?"wrong":""),value:k,readOnly:"view"===i,onChange:function(e){A(e.target.value)}})),E.a.createElement(dt.a,{className:"mb-3 ".concat("changePassword"===i?"d-flex":"d-none")},E.a.createElement(pt.a,{placeholder:"Password","aria-label":"Password",className:"text-normal ".concat("view"!==i&&m?"wrong":""),value:U,type:"password",onChange:function(e){L(e.target.value)}})),E.a.createElement(dt.a,{className:"mb-3 ".concat("changePassword"===i?"d-flex":"d-none")},E.a.createElement(pt.a,{placeholder:"Confirm password","aria-label":"Confirm password",value:H,className:"text-normal ".concat("view"!==i&&m?"wrong":""),type:"password",onChange:function(e){V(e.target.value)}})),E.a.createElement(dt.a,{className:"mb-3 ".concat("view"===i||"changeAvatar"===i?"d-none":"d-flex")},E.a.createElement(pt.a,{placeholder:"Old password","aria-label":"Old password",value:q,className:"text-normal ".concat("view"!==i&&m?"wrong":""),type:"password",onChange:function(e){z(e.target.value)}})),E.a.createElement("div",{className:"profile_control"},E.a.createElement(Et.a,{variant:"outline-primary",className:"btn-outline-custom text-bold ".concat("view"===i?"d-inline-block":"d-none"),onClick:function(){s("editData")}},"Edit profile"),E.a.createElement(Et.a,{variant:"outline-primary",className:"btn-outline-custom text-bold ".concat("view"===i?"d-inline-block":"d-none"),onClick:function(){s("changePassword")}},"Change password"),E.a.createElement(Et.a,{variant:"primary",className:"text-bold ".concat("view"!==i?"d-inline-block":"d-none"),onClick:function(){K()}},"Done")))}));var Dt={openPopup:qe,openDropdown:ze},Pt=Object(b.b)((function(e){return{navigation:e.navigation,user:e.user,app:e.app}}),Dt)((function(e){var t=e.openPopup,a=e.openDropdown,n=e.navigation,r=e.user,o=e.app;return E.a.createElement("div",{className:"content-header justify-content-between px-3 py-2 position-relative"},E.a.createElement("div",{className:"d-flex align-items-center",style:{width:"100px"}},E.a.createElement(mt,{url:r.avatar,size:"normal",className:"mr-3",onClick:function(){t({body:E.a.createElement(xt,null)})}})),E.a.createElement("h1",{className:"text-23 text-bold m-0 text-capitalize"},ut.string.capitalize(n.contentTab)),E.a.createElement("div",{className:"d-flex align-items-center",style:{width:"100px"}},E.a.createElement(Et.a,{variant:"outline-danger",className:"btn-outline-custom btn-circle mr-3",onClick:function(e){var t=e.target.getBoundingClientRect();a(E.a.createElement(wt,null),{x:o.viewType===m.WINDOW?t.left-10:t.left-130,y:t.bottom+15})}},E.a.createElement("i",{className:"fa fa-cog"})),E.a.createElement(Et.a,{variant:"outline-primary",className:"btn-outline-custom btn-circle mr-3",onClick:function(){t({header:{title:"User",btnRight:{title:"Done"}},body:E.a.createElement(It,null)})}},E.a.createElement("i",{className:"fa fa-user-plus",style:{fontSize:"18px"}}))))}));var Ft={chooseContentTab:tt},jt=Object(b.b)((function(e){return{navigation:e.navigation}}),Ft)((function(e){var t=e.navigation,a=e.chooseContentTab,n=t.contentTab;return E.a.createElement("div",{className:"content-footer px-3 pt-2"},E.a.createElement("div",{className:"footer-item ".concat(n===l.CONVERSATION?"active":""),onClick:function(){a(l.CONVERSATION)}},E.a.createElement("div",{className:"item-content"},E.a.createElement("i",{className:"fa fa-comment"}),E.a.createElement("p",{className:"text-bold"},"Chats"))),E.a.createElement("div",{className:"footer-item ".concat(n===l.PEOPLE?"active":""),onClick:function(){a(l.PEOPLE)}},E.a.createElement("div",{className:"item-content"},E.a.createElement("i",{className:"fa fa-users"}),E.a.createElement("p",{className:"text-bold"},"People"))))}));var Ut=Object(b.b)(null,{openPopup:qe})((function(e){var t=e.openPopup,a=e.chatroom,n=a.myChatroom,r=a.chatroom;return E.a.createElement("div",{className:"setting_drop_content drop_content"},E.a.createElement(Et.a,{variant:"outline-secondary drop_item",onClick:function(){t({body:E.a.createElement(ft,{content:"Are you sure you want to delete this conversation?",buttons:[{title:"Ok",primary:!0,func:function(){var e=$e.getSocket();e&&e.transmit(fe.packet.CHATROOM,{evt:fe.event.CHATROOM.UNFOLLOW,data:{chatroomId:r._id}})}},{title:"Cancel"}]})})}},"Delete"),E.a.createElement("div",{className:"drop_seperate"}),E.a.createElement(Et.a,{variant:"outline-secondary drop_item",onClick:function(){var e=$e.getSocket();e&&e.transmit(fe.packet.CHATROOM,{evt:n.read?fe.event.CHATROOM.MASK_AS_UNREAD:fe.event.CHATROOM.MASK_AS_READ,data:{userChatroomId:n._id}})}},n.read?"Mask as unread":"Mask as read"),E.a.createElement(Et.a,{variant:"outline-secondary drop_item",onClick:function(){var e=$e.getSocket();e&&e.transmit(fe.packet.CHATROOM,{evt:fe.event.CHATROOM.SET_ARCHIVE,data:{userChatroomId:n._id,archive:!n.archive}})}},n.archive?"Unarchive":"Archive"),E.a.createElement(Et.a,{variant:"outline-secondary drop_item",onClick:function(){var e=$e.getSocket();e&&e.transmit(fe.packet.CHATROOM,{evt:fe.event.CHATROOM.SET_BLOCK,data:{userChatroomId:n._id,block:!n.block}})}},n.block?"Unblock":"Block"))}));var Lt=Object(b.b)((function(e){return{user:e.user,friend:e.friend,navigation:e.navigation,app:e.app,typing:e.typing}}),{openDropdown:ze,setChatroomNavigation:nt})((function(e){var t,a,n,r,o,c,i,s,l,u,f=e.data,v=e.user,h=e.friend,N=e.navigation,O=e.openDropdown,g=e.setChatroomNavigation,b=e.app,T=e.typing,R=f.chatroom,S=f.friendsChatroom,y=f.myChatroom,C=R.lastMessage,_=R.name,I=R.type,k=R._id,A=Object(p.useState)(!1),w=Object(We.a)(A,2),x=w[0],D=w[1],P=S.map((function(e){return h.find((function(t){return t._id===e.user._id}))})),F=y.read||C&&C.user===v._id,j="conversation"===R.type?P.length>0&&(null===(t=P[0])||void 0===t?void 0:t.nickname)?null===(a=P[0])||void 0===a?void 0:a.nickname:"".concat(null===(n=S[0])||void 0===n||null===(r=n.user)||void 0===r?void 0:r.lastName," ").concat(null===(o=S[0])||void 0===o||null===(c=o.user)||void 0===c?void 0:c.firstName):_,U=N.chatroom===R._id,L=T[R._id],M=L&&L.some((function(e){return e._id!==v._id})),G=new Date(R.updateTime),H=new Date,V="";V=H.getTime()-G.getTime()<864e5&&H.getDate()===G.getDate()?"".concat(ut.string.zeroPad(G.getHours(),2),":").concat(ut.string.zeroPad(G.getMinutes(),2)):"".concat(G.getDate()," Th\xe1ng ").concat(G.getMonth()+1);var B=C&&C.user===v._id?"You: ":"",Q=N.conversationView===d.NORMAL&&y.show&&!y.block&&!y.archive&&y.active||N.conversationView===d.ARCHIVE&&y.show&&y.archive&&y.active||N.conversationView===d.BLOCK&&y.show&&y.block&&y.active;return E.a.createElement("div",{className:"conversation-item px-2 ".concat(Q?"d-block":"d-none"),onMouseOver:function(){D(!0)},onMouseLeave:function(){D(!1)}},E.a.createElement("div",{className:"conversation-background px-2 py-2 ".concat(U?"active":"")},E.a.createElement("div",{className:"left",onClick:function(){var e=$e.getSocket();!y.read&&e&&e.transmit(fe.packet.CHATROOM,{evt:fe.event.CHATROOM.MASK_AS_READ,data:{userChatroomId:y._id}}),g(k)}},E.a.createElement(mt,{online:"conversation"===R.type&&1===S.length&&S[0]?{status:null===(i=S[0])||void 0===i||null===(s=i.user)||void 0===s?void 0:s.online,lastOnlineTime:null===(l=S[0])||void 0===l||null===(u=l.user)||void 0===u?void 0:u.lastOnlineTime}:void 0,url:"conversation"===I&&1===S.length?S[0].user.avatar:void 0,size:"medium"}),E.a.createElement("div",{className:"info ml-2"},E.a.createElement("p",{className:"text-15 ".concat(F?"text-bold":"text-bolder")},j),E.a.createElement("div",{className:"last-message",style:{visibility:C?"visible":"hidden"}},M?E.a.createElement("div",{className:"dotsContainer"},E.a.createElement("span",{id:"dot1"}),E.a.createElement("span",{id:"dot2"}),E.a.createElement("span",{id:"dot3"})):E.a.createElement(E.a.Fragment,null,E.a.createElement("p",{className:"text-bold text-light"},"".concat(B).concat(null===C||void 0===C?void 0:C.message)),E.a.createElement("p",{className:"text-bold text-light"},E.a.createElement("span",null,"\xb7 ")," ".concat(V)))))),E.a.createElement("div",{className:"right"},x?E.a.createElement("button",{onClick:function(e){var t=e.target.getBoundingClientRect();O(E.a.createElement(Ut,{chatroom:f}),{x:b.viewType===m.WINDOW?t.left-10:t.left-130,y:t.bottom+5})}},E.a.createElement("i",{className:"fa fa-ellipsis-h"})):F?C&&C.user===v._id?E.a.createElement(mt,{url:"conversation"===I&&1===S.length&&S[0].read?S[0].user.avatar:void 0,size:"tiny",className:"".concat(S.some((function(e){return e.read}))?"d-inline-flex":"d-none")}):E.a.createElement(E.a.Fragment,null):E.a.createElement("div",{className:"dot"}))))}));var Mt=Object(b.b)((function(e){return{chatroom:e.chatroom}}))((function(e){var t=e.chatroom,a=Object(p.useState)(!1),n=Object(We.a)(a,2),r=n[0],o=n[1],c=Object(p.useState)(""),i=Object(We.a)(c,2),s=i[0],l=i[1];Object(p.useEffect)((function(){var e=document.getElementById("list-conversation");e&&e.addEventListener("scroll",(function(a){a.target.scrollTop;if(a.target.scrollHeight-a.target.scrollTop===(null===e||void 0===e?void 0:e.clientHeight)&&!r){o(!0);var n=$e.getSocket();n&&n.transmit(fe.packet.CHATROOM,{evt:fe.event.CHATROOM.GETALLUSERCHATROOMS,data:{skip:t.length}}),setTimeout((function(){o(!1)}),1e3)}}))}));var u=t.filter((function(e){return e.friendsChatroom.some((function(e){return new RegExp(".*".concat(s,".*"),"i").test(e.user.email)||new RegExp(".*".concat(s,".*"),"i").test(e.user.firstName)||new RegExp(".*".concat(s,".*"),"i").test(e.user.lastName)||new RegExp(".*".concat(s,".*"),"i").test(e.user.nickname)}))}));return E.a.createElement("div",{className:"content-conversation"},E.a.createElement("div",{className:"px-3 pt-2 pb-3"},E.a.createElement(dt.a,{className:"search"},E.a.createElement(dt.a.Prepend,null,E.a.createElement(dt.a.Text,{id:"basic-addon1"},E.a.createElement("i",{className:"fa fa-search"}))),E.a.createElement(pt.a,{placeholder:"Find on message","aria-label":"Username","aria-describedby":"basic-addon1",onChange:function(e){l(e.target.value)}}))),E.a.createElement("div",{className:"list-conversation",id:"list-conversation"},u.map((function(e,t){return E.a.createElement(Lt,{data:e,key:t})}))))}));function Gt(e){var t=e.data,a=t.from,n=t._id,r=a.avatar,o=a.firstName,c=a.lastName;return E.a.createElement("div",{className:"request-item mx-3 py-3"},E.a.createElement("div",{className:"d-flex align-items-center"},E.a.createElement(mt,{url:r,size:"normal"}),E.a.createElement("p",{className:"ml-2 text-normal text-18"},"".concat(c," ").concat(o))),E.a.createElement("div",null,E.a.createElement(Et.a,{variant:"outline-danger",className:"btn-outline-custom",onClick:function(){var e=$e.getSocket();e&&e.transmit(fe.packet.FRIEND,{evt:fe.event.FRIEND.REFUSEFRIENDREQUEST,data:{requestId:n}})}},"Refuse"),E.a.createElement(Et.a,{variant:"outline-primary",className:"btn-outline-custom ml-2",onClick:function(){var e=$e.getSocket();e&&e.transmit(fe.packet.FRIEND,{evt:fe.event.FRIEND.ACCEPTFRIENDREQUEST,data:{requestId:n}})}},"Accept")))}var Ht=Object(b.b)((function(e){return{friendRequest:e.friendRequest}}))((function(e){var t=e.friendRequest.receive;return E.a.createElement("div",{className:"list-request"},t.map((function(e,t){return E.a.createElement(Gt,{data:e,key:t})})))}));var Vt=Object(b.b)((function(e){return{friend:e.friend}}),{openPopup:qe})((function(e){var t=e.data,a=e.openPopup,n=t.avatar,r=t.firstName,o=t.lastName,c=t.nickname,i=t.online,s=t.lastOnlineTime;return E.a.createElement("div",{className:"people-item px-3 py-2",style:{cursor:"pointer"},onClick:function(){a({body:E.a.createElement(ht,{data:t,form:"friend"})})}},E.a.createElement(mt,{url:n,size:"normal",online:{status:i,lastOnlineTime:s}}),E.a.createElement("p",{className:"people-item-name text-normal text-18"},c||"".concat(o," ").concat(r)))})),Bt=Object(b.b)((function(e){return{friend:e.friend}}))((function(e){var t=e.friend,a=t.filter((function(e){return e.online})),n=t.filter((function(e){return!e.online}));return E.a.createElement("div",{className:"list-people"},a.length?E.a.createElement(E.a.Fragment,null,E.a.createElement("p",{className:"text-normal text-light text-uppercase text-12 px-3 py-2"},"Active now"),a.map((function(e,t){return E.a.createElement(Vt,{data:e,key:t})}))):E.a.createElement(E.a.Fragment,null),n.length?E.a.createElement(E.a.Fragment,null,E.a.createElement("p",{className:"text-normal text-light text-uppercase text-12 px-3 py-2"},"Friends"),n.map((function(e,t){return E.a.createElement(Vt,{data:e,key:t})}))):E.a.createElement(E.a.Fragment,null))}));var Qt={choosePeopleTab:at},qt=Object(b.b)((function(e){return{navigation:e.navigation,friend:e.friend,friendRequest:e.friendRequest}}),Qt)((function(e){var t=e.navigation,a=e.friend,n=e.friendRequest,r=e.choosePeopleTab;return E.a.createElement("div",{className:"content-people"},E.a.createElement("div",{className:"navigation px-3 py-2"},E.a.createElement(Et.a,{variant:"outline-primary",className:"btn-outline-custom ".concat(t.peopleTab===u.PEOPLE?"text-dark":"text-light"),onClick:function(){r(u.PEOPLE)}},"Friends".concat(a.length?" (".concat(a.length,")"):"")),E.a.createElement(Et.a,{variant:"outline-primary",className:"btn-outline-custom ".concat(t.peopleTab===u.REQUEST?"text-dark":"text-light"),onClick:function(){r(u.REQUEST)}},"Request".concat(n.receive.length?" (".concat(n.receive.length,")"):""))),t.peopleTab===u.PEOPLE?E.a.createElement(Bt,null):t.peopleTab===u.REQUEST?E.a.createElement(Ht,null):E.a.createElement(E.a.Fragment,null))})),zt=void 0;var Wt=Object(b.b)((function(e){return{navigation:e.navigation}}))((function(e){var t=e.navigation,a=Object(p.useState)(0),n=Object(We.a)(a,2),r=(n[0],n[1]);window.addEventListener("resize",(function(){zt&&(clearTimeout(zt),zt=void 0),zt=setTimeout((function(){zt&&(clearTimeout(zt),zt=void 0),r(Math.random())}),100)}));var o=window.innerHeight-54-56;return E.a.createElement("div",{className:"content-body",style:{height:o}},t.contentTab===l.CONVERSATION?E.a.createElement(Mt,null):t.contentTab===l.PEOPLE?E.a.createElement(qt,null):E.a.createElement(E.a.Fragment,null))}));function Kt(e){var t=e.data,a=t._id,n=t.from;return E.a.createElement("div",{className:"d-flex align-items-center"},E.a.createElement("div",{className:"mr-2"},E.a.createElement("p",{className:"text-normal"},E.a.createElement("strong",{className:"text-bold"},"".concat(n.lastName," ").concat(n.firstName))," has sent a friend request")),E.a.createElement("div",{className:"d-flex"},E.a.createElement(Et.a,{variant:"danger",className:"text-normal py-1 px-3 text-12",onClick:function(){var e=$e.getSocket();e&&e.transmit(fe.packet.FRIEND,{evt:fe.event.FRIEND.REFUSEFRIENDREQUEST,data:{requestId:a}})}},"Refuse"),E.a.createElement(Et.a,{variant:"primary",className:"text-normal py-1 px-3 ml-2 text-12",onClick:function(){var e=$e.getSocket();e&&e.transmit(fe.packet.FRIEND,{evt:fe.event.FRIEND.ACCEPTFRIENDREQUEST,data:{requestId:a}})}},"Accept")))}function Yt(e){var t=e.data,a=t.firstName,n=t.lastName,r=t.avatar;return E.a.createElement("div",{className:"d-flex align-items-center"},E.a.createElement(mt,{url:r,size:"small",className:"mr-2"}),E.a.createElement("div",null,E.a.createElement("p",{className:"text-normal"},"You have become ",E.a.createElement("strong",{className:"text-bold"},"".concat(n," ").concat(a,"'s"))," friends")))}var Jt=void 0,Zt=function(e){Object(O.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(h.a)(this,a),(n=t.call(this,e)).socketHandle=n.socketHandle.bind(Object(Xe.a)(n)),n.getSocketData=n.getSocketData.bind(Object(Xe.a)(n)),n}return Object(N.a)(a,[{key:"UNSAFE_componentWillMount",value:function(){this.socketHandle()}},{key:"componentDidMount",value:function(){this.getSocketData()}},{key:"socketHandle",value:function(){var e=this.props,t=e.app,a=e.user,n=e.navigation,r=e.cleanUserData,o=fe.packet,c=fe.event;$e.init({deviceId:t.deviceId});var i=$e.getSocket();if(i){i.listener("disconnect").once().then((function(){r()}));var s=this.props.updateFriendData;Object(Oe.a)(Ne.a.mark((function e(){var t,a,n,r,c,l,u;return Ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=!0,a=!1,e.prev=2,r=Object(et.a)(i.receiver(o.FRIEND_UPDATE_DATA));case 4:return e.next=6,r.next();case 6:return c=e.sent,t=c.done,e.next=10,c.value;case 10:if(l=e.sent,t){e.next=18;break}u=l,console.log(u),s(u);case 15:t=!0,e.next=4;break;case 18:e.next=24;break;case 20:e.prev=20,e.t0=e.catch(2),a=!0,n=e.t0;case 24:if(e.prev=24,e.prev=25,t||null==r.return){e.next=29;break}return e.next=29,r.return();case 29:if(e.prev=29,!a){e.next=32;break}throw n;case 32:return e.finish(29);case 33:return e.finish(24);case 34:case"end":return e.stop()}}),e,null,[[2,20,24,34],[25,,29,33]])})))();var d=this.props,p=d.popReceiveRequest,f=d.popSentRequest,v=d.pushReceiveRequest,h=d.pushSentRequest,N=d.pushFriend,O=d.popFriend,g=d.pushToast,b=d.chooseContentTab,T=d.choosePeopleTab;Object(Oe.a)(Ne.a.mark((function e(){var t,n,r,s,m,d,R,S,y;return Ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=!0,n=!1,e.prev=2,s=Object(et.a)(i.receiver(o.FRIEND));case 4:return e.next=6,s.next();case 6:return m=e.sent,t=m.done,e.next=10,m.value;case 10:if(d=e.sent,t){e.next=19;break}S=(R=d).evt,y=R.payload,console.log(S,y),S===c.FRIEND.RECEIVEFRIENDREQUEST?y.from._id===a._id?h(y):(v(y),g({content:E.a.createElement(Kt,{data:y}),time:new Date,onClick:function(){b(l.PEOPLE),T(u.REQUEST)}})):S===c.FRIEND.REMOVEFRIENDREQUEST?y.from._id===a._id?f(y):p(y):S===c.FRIEND.ONACCEPTFRIENDREQUEST?(N(y),g({content:E.a.createElement(Yt,{data:y}),time:new Date})):S===c.FRIEND.ONREMOVEFRIEND&&O(y);case 16:t=!0,e.next=4;break;case 19:e.next=25;break;case 21:e.prev=21,e.t0=e.catch(2),n=!0,r=e.t0;case 25:if(e.prev=25,e.prev=26,t||null==s.return){e.next=30;break}return e.next=30,s.return();case 30:if(e.prev=30,!n){e.next=33;break}throw r;case 33:return e.finish(30);case 34:return e.finish(25);case 35:case"end":return e.stop()}}),e,null,[[2,21,25,35],[26,,30,34]])})))();var R=this.props,S=R.updateChatroom,y=R.setTyping;Object(Oe.a)(Ne.a.mark((function e(){var a,r,s,l,u,d,p,E,f;return Ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=!0,r=!1,e.prev=2,l=Object(et.a)(i.receiver(o.CHATROOM));case 4:return e.next=6,l.next();case 6:return u=e.sent,a=u.done,e.next=10,u.value;case 10:if(d=e.sent,a){e.next=19;break}E=(p=d).evt,f=p.payload,console.log(E,f),E===c.CHATROOM.UPDATE?(t.viewType===m.MOBILE||n.chatroom||F(f.chatroom._id),S(f)):E===c.CHATROOM.SEND_TYPING&&y(f);case 16:a=!0,e.next=4;break;case 19:e.next=25;break;case 21:e.prev=21,e.t0=e.catch(2),r=!0,s=e.t0;case 25:if(e.prev=25,e.prev=26,a||null==l.return){e.next=30;break}return e.next=30,l.return();case 30:if(e.prev=30,!r){e.next=33;break}throw s;case 33:return e.finish(30);case 34:return e.finish(25);case 35:case"end":return e.stop()}}),e,null,[[2,21,25,35],[26,,30,34]])})))();var C=this.props.receiveMessage;Object(Oe.a)(Ne.a.mark((function e(){var a,n,r,s,l,u,m,d,p;return Ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=!0,n=!1,e.prev=2,s=Object(et.a)(i.receiver(o.MESSAGE));case 4:return e.next=6,s.next();case 6:return l=e.sent,a=l.done,e.next=10,l.value;case 10:if(u=e.sent,a){e.next=19;break}d=(m=u).evt,p=m.payload,console.log(d,p),d===c.MESSAGE.RECEIVE&&(t.sound&&new Audio("./src/mp3/message.mp3").play(),C(p));case 16:a=!0,e.next=4;break;case 19:e.next=25;break;case 21:e.prev=21,e.t0=e.catch(2),n=!0,r=e.t0;case 25:if(e.prev=25,e.prev=26,a||null==s.return){e.next=30;break}return e.next=30,s.return();case 30:if(e.prev=30,!n){e.next=33;break}throw r;case 33:return e.finish(30);case 34:return e.finish(25);case 35:case"end":return e.stop()}}),e,null,[[2,21,25,35],[26,,30,34]])})))();var _=this.props,I=_.getFriend,k=_.setFriendNickName,A=_.getFriendRequest;Object(Oe.a)(Ne.a.mark((function e(){var t,a,n,r,s,l,u,m,d;return Ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=!0,a=!1,e.prev=2,r=Object(et.a)(i.receiver(o.FRIEND));case 4:return e.next=6,r.next();case 6:return s=e.sent,t=s.done,e.next=10,s.value;case 10:if(l=e.sent,t){e.next=19;break}m=(u=l).evt,d=u.payload,console.log(m,d),m===c.FRIEND.GET?I(d):m===c.FRIEND.SETNICKNAME?k(d):m===c.FRIEND.REMOVE||(m===c.FRIEND.GETFRIENDREQUEST?A(d):m===c.FRIEND.SENDFRIENDREQUEST||m===c.FRIEND.ACCEPTFRIENDREQUEST||m===c.FRIEND.REFUSEFRIENDREQUEST||c.FRIEND.CANCELFRIENDREQUEST);case 16:t=!0,e.next=4;break;case 19:e.next=25;break;case 21:e.prev=21,e.t0=e.catch(2),a=!0,n=e.t0;case 25:if(e.prev=25,e.prev=26,t||null==r.return){e.next=30;break}return e.next=30,r.return();case 30:if(e.prev=30,!a){e.next=33;break}throw n;case 33:return e.finish(30);case 34:return e.finish(25);case 35:case"end":return e.stop()}}),e,null,[[2,21,25,35],[26,,30,34]])})))();var w=this.props,x=w.getAllChatrooms,D=w.createChatroom,P=w.unfollowChatroom,F=w.setChatroomNavigation;Object(Oe.a)(Ne.a.mark((function e(){var a,n,r,s,l,u,d,p,E;return Ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=!0,n=!1,e.prev=2,s=Object(et.a)(i.receiver(o.CHATROOM));case 4:return e.next=6,s.next();case 6:return l=e.sent,a=l.done,e.next=10,l.value;case 10:if(u=e.sent,a){e.next=19;break}p=(d=u).evt,E=d.payload,console.log(p,E),p===c.CHATROOM.CREATE?D(E):p===c.CHATROOM.UNFOLLOW?P(E):p===c.CHATROOM.INVITE||p===c.CHATROOM.GETALLUSERCHATROOMS&&(x(E),E.data&&E.data.length&&t.viewType===m.WINDOW&&F(E.data[0].chatroom._id));case 16:a=!0,e.next=4;break;case 19:e.next=25;break;case 21:e.prev=21,e.t0=e.catch(2),n=!0,r=e.t0;case 25:if(e.prev=25,e.prev=26,a||null==s.return){e.next=30;break}return e.next=30,s.return();case 30:if(e.prev=30,!n){e.next=33;break}throw r;case 33:return e.finish(30);case 34:return e.finish(25);case 35:case"end":return e.stop()}}),e,null,[[2,21,25,35],[26,,30,34]])})))();var j=this.props.getMessages;Object(Oe.a)(Ne.a.mark((function e(){var t,a,n,r,s,l,u,m,d;return Ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=!0,a=!1,e.prev=2,r=Object(et.a)(i.receiver(o.MESSAGE));case 4:return e.next=6,r.next();case 6:return s=e.sent,t=s.done,e.next=10,s.value;case 10:if(l=e.sent,t){e.next=19;break}m=(u=l).evt,d=u.payload,console.log(m,d),m===c.MESSAGE.GET&&j(d);case 16:t=!0,e.next=4;break;case 19:e.next=25;break;case 21:e.prev=21,e.t0=e.catch(2),a=!0,n=e.t0;case 25:if(e.prev=25,e.prev=26,t||null==r.return){e.next=30;break}return e.next=30,r.return();case 30:if(e.prev=30,!a){e.next=33;break}throw n;case 33:return e.finish(30);case 34:return e.finish(25);case 35:case"end":return e.stop()}}),e,null,[[2,21,25,35],[26,,30,34]])})))()}}},{key:"getSocketData",value:function(){var e=fe.packet,t=fe.event,a=$e.getSocket();a&&(a.transmit(e.FRIEND,{evt:t.FRIEND.GET}),a.transmit(e.FRIEND,{evt:t.FRIEND.GETFRIENDREQUEST}),a.transmit(e.CHATROOM,{evt:t.CHATROOM.GETALLUSERCHATROOMS}))}},{key:"render",value:function(){var e=this.props,t=e.app,a=e.navigation;return Jt&&(clearTimeout(Jt),Jt=void 0),t.unreadChatroom?(ut.common.changeFAVIcon("./src/images/icon-noti.svg"),Jt=setInterval((function(){document.title=document.title!==fe.config.APP_NAME?fe.config.APP_NAME:"You have received a new message"}),1e3)):(ut.common.changeFAVIcon("./src/images/icon.svg"),document.title=fe.config.APP_NAME),E.a.createElement("div",{className:"home"},t.viewType===m.MOBILE?E.a.createElement(E.a.Fragment,null,a.chatroom?E.a.createElement(Ct,null):E.a.createElement("div",{className:"content"},E.a.createElement(Pt,null),E.a.createElement(Wt,null),E.a.createElement(jt,null))):E.a.createElement(E.a.Fragment,null,E.a.createElement("div",{className:"content"},E.a.createElement(Pt,null),E.a.createElement(Wt,null),E.a.createElement(jt,null)),E.a.createElement(Ct,null)))}}]),a}(p.Component),$t={cleanUserData:function(){return{type:fe.action.CLEAN_USER_DATA}},getFriend:function(e){var t=e.success,a=e.data,n=e.message;return function(){var e=Object(Oe.a)(Ne.a.mark((function e(r){return Ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t?r({type:fe.action.FRIEND_GET,payload:a}):console.log(n);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},setFriendNickName:function(e){var t=e.success,a=e.data,n=e.message;return function(){var e=Object(Oe.a)(Ne.a.mark((function e(r){return Ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t?r({type:fe.action.FRIEND_SETNICKNAME,payload:a}):console.log(n);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},updateFriendData:function(e){return function(){var t=Object(Oe.a)(Ne.a.mark((function t(a){return Ne.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a({type:fe.action.FRIEND_UPDATE_DATA,payload:e});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},getFriendRequest:function(e){var t=e.success,a=e.data,n=e.message;return function(){var e=Object(Oe.a)(Ne.a.mark((function e(r){return Ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t?r({type:fe.action.FRIENDREQUEST_GET,payload:a}):console.log(n);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},popReceiveRequest:function(e){return{type:fe.action.FRIENDREQUEST_POP_RECEVICE,payload:e}},popSentRequest:function(e){return{type:fe.action.FRIENDREQUEST_POP_SENT,payload:e}},pushReceiveRequest:function(e){return{type:fe.action.FRIENDREQUEST_PUSH_RECEVICE,payload:e}},pushSentRequest:function(e){return{type:fe.action.FRIENDREQUEST_PUSH_SENT,payload:e}},pushFriend:function(e){return{type:fe.action.FRIEND_PUSH,payload:e}},popFriend:function(e){return{type:fe.action.FRIEND_POP,payload:e}},pushToast:Be,chooseContentTab:tt,choosePeopleTab:at,getAllChatrooms:function(e){var t=e.success,a=e.data,n=e.message;return function(){var e=Object(Oe.a)(Ne.a.mark((function e(r){return Ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t?r({type:fe.action.CHATROOM_GETALLUSERCHATROOMS,payload:a}):console.log(n);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},createChatroom:function(e){var t=e.success,a=e.data,n=e.message;return function(){var e=Object(Oe.a)(Ne.a.mark((function e(r){return Ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t?a&&a.chatroom&&(r(nt(a.chatroom._id)),r({type:fe.action.CHATROOM_CREATE,payload:a})):console.log(n);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},unfollowChatroom:function(e){var t=e.success,a=e.data,n=e.message;return function(){var e=Object(Oe.a)(Ne.a.mark((function e(r){return Ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t?r({type:fe.action.CHATROOM_UNFOLLOW,payload:a}):console.log(n);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},updateChatroom:function(e){return function(){var t=Object(Oe.a)(Ne.a.mark((function t(a){return Ne.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a((n=!e.myChatroom.read,{type:fe.action.SET_UNREAD_STATE,payload:n})),a({type:fe.action.CHATROOM_UPDATE,payload:e});case 2:case"end":return t.stop()}var n}),t)})));return function(e){return t.apply(this,arguments)}}()},receiveMessage:function(e){return function(){var t=Object(Oe.a)(Ne.a.mark((function t(a){return Ne.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a({type:fe.action.MESSAGE_RECEIVE,payload:e});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},getMessages:function(e){var t=e.success,a=e.data,n=e.message;return function(){var e=Object(Oe.a)(Ne.a.mark((function e(r){return Ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t?r({type:fe.action.MESSAGE_GET,payload:a}):console.log(n);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},setChatroomNavigation:nt,setTyping:function(e){return function(){var t=Object(Oe.a)(Ne.a.mark((function t(a){return Ne.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a({type:fe.action.TYPING,payload:e});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}},Xt=Object(b.b)((function(e){return{app:e.app,user:e.user,navigation:e.navigation}}),$t)(Zt),ea=a(191),ta=a(198),aa=a(192),na=function(e){Object(O.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(h.a)(this,a),(n=t.call(this,e)).emailRef=void 0,n.passwordRef=void 0,n.confirmpasswordRef=void 0,n.firstNameRef=void 0,n.lastNameRef=void 0,n.state={viewType:s.SIGNIN,email:"",firstName:"",lastName:"",password:"",confirmPassword:"",isEmailFail:"",isPasswordFail:"",isConfirmPasswordFail:"",isFirstNameFail:"",isLastNameFail:""},n.emailRef=E.a.createRef(),n.passwordRef=E.a.createRef(),n.confirmpasswordRef=E.a.createRef(),n.firstNameRef=E.a.createRef(),n.lastNameRef=E.a.createRef(),n.onChangeEmail=n.onChangeEmail.bind(Object(Xe.a)(n)),n.onChangeFirstName=n.onChangeFirstName.bind(Object(Xe.a)(n)),n.onChangeLastName=n.onChangeLastName.bind(Object(Xe.a)(n)),n.onChangePassword=n.onChangePassword.bind(Object(Xe.a)(n)),n.onChangeComfirmPassword=n.onChangeComfirmPassword.bind(Object(Xe.a)(n)),n.onBlurEmail=n.onBlurEmail.bind(Object(Xe.a)(n)),n.onBlurPassword=n.onBlurPassword.bind(Object(Xe.a)(n)),n.onBlurConfirmPassword=n.onBlurConfirmPassword.bind(Object(Xe.a)(n)),n.onBlurFirstName=n.onBlurFirstName.bind(Object(Xe.a)(n)),n.onBlurLastName=n.onBlurLastName.bind(Object(Xe.a)(n)),n.onClickSetViewType=n.onClickSetViewType.bind(Object(Xe.a)(n)),n.onLoginSubmit=n.onLoginSubmit.bind(Object(Xe.a)(n)),n}return Object(N.a)(a,[{key:"onChangeEmail",value:function(e){this.setState({email:e.target.value})}},{key:"onChangeFirstName",value:function(e){this.setState({firstName:e.target.value})}},{key:"onChangeLastName",value:function(e){this.setState({lastName:e.target.value})}},{key:"onChangePassword",value:function(e){this.setState({password:e.target.value})}},{key:"onChangeComfirmPassword",value:function(e){this.setState({confirmPassword:e.target.value})}},{key:"onBlurEmail",value:function(e){var t=ut.common.validateEmail(e.target.value);this.setState({isEmailFail:t?"":"Invalid email format"})}},{key:"onBlurPassword",value:function(e){var t=e.target.value,a=t.length>=8||t.length<=32;this.setState({isPasswordFail:a?"":"Password length must be 8 character or more"})}},{key:"onBlurConfirmPassword",value:function(e){var t=e.target.value,a=t.length>=8||t.length<=32;this.setState({isConfirmPasswordFail:a?"":"Confirm password length must be 8 character or more"})}},{key:"onBlurFirstName",value:function(e){var t=!!e.target.value.length;this.setState({isFirstNameFail:t?"":"First name required"})}},{key:"onBlurLastName",value:function(e){var t=!!e.target.value.length;this.setState({isLastNameFail:t?"":"Last name required"})}},{key:"onClickSetViewType",value:function(e){this.setState({viewType:e,email:"",firstName:"",lastName:"",password:"",confirmPassword:"",isEmailFail:"",isPasswordFail:"",isConfirmPasswordFail:"",isFirstNameFail:"",isLastNameFail:""})}},{key:"onLoginSubmit",value:function(e){var t=this.state,a=t.email,n=t.password,r=t.confirmPassword,o=t.firstName,c=t.lastName,i=t.viewType;e.preventDefault(),n.length<8||n.length>32?this.setState({isPasswordFail:"Password length must be 8 character or more"}):i!==s.SIGNUP||n===r?i===s.SIGNIN?this.props.login(a,n):i===s.SIGNUP&&this.props.register({email:a,password:n,confirmPassword:r,firstName:o,lastName:c}):this.setState({isConfirmPasswordFail:"Password confirmation doesn't match password"})}},{key:"render",value:function(){var e=this,t=this.state,a=t.viewType,n=t.email,r=t.firstName,o=t.lastName,c=t.password,i=t.confirmPassword,l=t.isEmailFail,u=t.isConfirmPasswordFail,m=t.isFirstNameFail,d=t.isLastNameFail,p=t.isPasswordFail;return E.a.createElement("div",{className:"login"},E.a.createElement("div",{className:"content"},E.a.createElement("div",{className:"icon  mb-2"},E.a.createElement("i",{className:"fa fa-paper-plane"})),E.a.createElement("h1",{className:"text-40 mb-4"}," Messenger "),E.a.createElement("h2",{className:"text-16 mb-3 text-normal"}," Instantly connect with people in your life "),E.a.createElement("p",{className:"text-16  mb-4 text-normal"}," Sign in to get started. "),E.a.createElement(Ot.a,{className:"input",onSubmit:this.onLoginSubmit},E.a.createElement(ea.a,{"aria-label":"Basic example"},E.a.createElement(Et.a,{variant:"outline-primary",className:"btn-left text-17 ".concat(a===s.SIGNIN?"text-bolder":"text-normal"),block:!0,onClick:function(){e.onClickSetViewType(s.SIGNIN)}},"Sign in"),E.a.createElement(Et.a,{variant:"outline-primary",className:"btn-right text-17 ".concat(a===s.SIGNUP?"text-bolder":"text-normal"),block:!0,onClick:function(){e.onClickSetViewType(s.SIGNUP)}},"Sign up")),E.a.createElement(Ot.a.Group,{controlId:"formBasicEmail",className:"form-middle"},E.a.createElement(Ot.a.Control,{type:"email",placeholder:"Email",className:"text-17 ".concat(l?"invalid":""),value:n,ref:this.emailRef,onChange:this.onChangeEmail,onBlur:this.onBlurEmail}),E.a.createElement(ta.a,{target:this.emailRef,show:!!l,placement:"right"},E.a.createElement(aa.a,{id:"email-tool-tip"},l))),E.a.createElement(Ot.a.Group,{controlId:"formBasicPassword",className:"".concat(a===s.SIGNIN?"d-none":""," form-middle")},E.a.createElement(Ot.a.Control,{type:"text",placeholder:"First name",className:"text-17 form-left ".concat(m?"invalid":""),value:r,ref:this.firstNameRef,onChange:this.onChangeFirstName,onBlur:this.onBlurFirstName}),E.a.createElement(Ot.a.Control,{type:"text",placeholder:"Last name",className:"text-17 form-right ".concat(d?"invalid":""),value:o,ref:this.lastNameRef,onChange:this.onChangeLastName,onBlur:this.onBlurLastName}),E.a.createElement(ta.a,{target:this.lastNameRef,show:!(!d&&!m),placement:"right"},E.a.createElement(aa.a,{id:"ln-tool-tip"},m||(d||"")))),E.a.createElement(Ot.a.Group,{controlId:"formBasicPassword",className:"".concat(a===s.SIGNIN?"form-bottom":"form-middle")},E.a.createElement(Ot.a.Control,{type:"password",placeholder:"Password",className:"text-17",value:c,ref:this.passwordRef,onChange:this.onChangePassword,onBlur:this.onBlurPassword}),E.a.createElement(ta.a,{target:this.passwordRef,show:!!p,placement:"right"},E.a.createElement(aa.a,{id:"pw-tool-tip"},p))),E.a.createElement(Ot.a.Group,{controlId:"formBasicPassword",className:"".concat(a===s.SIGNIN?"d-none":""," form-bottom")},E.a.createElement(Ot.a.Control,{type:"password",placeholder:"Confirm password",className:"text-17",value:i,ref:this.confirmpasswordRef,onChange:this.onChangeComfirmPassword,onBlur:this.onBlurConfirmPassword}),E.a.createElement(ta.a,{target:this.confirmpasswordRef,show:!!u,placement:"right"},E.a.createElement(aa.a,{id:"cfpw-tool-tip"},u))),E.a.createElement(Et.a,{variant:"link",type:"submit",className:"text-23 text-primary mb-4"},"Continue"))))}}]),a}(p.Component),ra={login:function(e,t){return function(){var a=Object(Oe.a)(Ne.a.mark((function a(n){var r;return Ne.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,we(e,t);case 2:(r=a.sent).success?n({type:fe.action.LOGIN,payload:r.data.user}):console.log(r.message);case 4:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()},register:function(e){return function(){var t=Object(Oe.a)(Ne.a.mark((function t(a){var n;return Ne.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ke(e);case 2:(n=t.sent).success?a({type:fe.action.REGISTER,payload:n.data.user}):console.log(n.message);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}},oa=Object(b.b)(null,ra)(na),ca=a(43),ia=function(e){Object(O.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(h.a)(this,a),(n=t.call(this,e)).state={verifying:!1},n.onClickResend=n.onClickResend.bind(Object(Xe.a)(n)),n}return Object(N.a)(a,[{key:"UNSAFE_componentWillMount",value:function(){var e=Object(Oe.a)(Ne.a.mark((function e(){var t;return Ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=document.location.pathname.split("/").filter((function(e){return e}))[1])){e.next=6;break}return this.setState({verifying:!0}),e.next=5,this.props.verify(t);case 5:this.setState({verifying:!1});case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onClickResend",value:function(){var e=Object(Oe.a)(Ne.a.mark((function e(){return Ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ue();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props.user,t=this.state.verifying;return E.a.createElement("div",{className:"verify"},E.a.createElement("div",{className:"verify-content"},t?E.a.createElement(E.a.Fragment,null):E.a.createElement(E.a.Fragment,null,e.emailVerify.verified?E.a.createElement(E.a.Fragment,null,E.a.createElement("i",{className:"fa fa-check-circle d-block text-center text-success",style:{fontSize:"120px"}}),E.a.createElement("p",{className:"text-30 text-normal mb-3"},"Your account has verified"),E.a.createElement(ca.b,{to:"/",className:"d-block text-16 text-normal text-center"},"Go to home page")):E.a.createElement(E.a.Fragment,null,E.a.createElement("i",{className:"fa fa-times-circle d-block text-center text-danger",style:{fontSize:"120px"}}),E.a.createElement("p",{className:"text-30 text-normal mb-3"},"Your account hasn't been verify"),E.a.createElement(Et.a,{className:"text-16 text-normal",block:!0,onClick:this.onClickResend},"Resend")))))}}]),a}(p.Component),sa={verify:function(e){return function(){var t=Object(Oe.a)(Ne.a.mark((function t(a){var n;return Ne.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Fe(e);case 2:(n=t.sent).success?a({type:fe.action.VERIFY}):console.log(n.message);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}},la=Object(b.b)((function(e){return{user:e.user}}),sa)(ia);var ua=Object(b.b)((function(e){return{user:e.user}}))((function(e){return e.user,E.a.createElement(Ke.d,null,E.a.createElement(Ke.b,{path:"/login"},E.a.createElement(oa,null)),E.a.createElement(Ke.b,{path:"/",exact:!0},E.a.createElement(Xt,null)),E.a.createElement(Ke.b,{path:"/verify"},E.a.createElement(la,null)))}));var ma={token:function(){return function(){var e=Object(Oe.a)(Ne.a.mark((function e(t){var a;return Ne.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,De();case 2:(a=e.sent).success?t({type:fe.action.TOKEN,payload:a.data.user}):t({type:fe.action.TOKEN,payload:{}});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}},da=Object(b.b)((function(e){return{user:e.user}}),ma)((function(e){var t=e.user,a=e.token,n=Object(p.useState)(!1),r=Object(We.a)(n,2),o=r[0],c=r[1];return!t.email&&Ie().authorization&&Ie().deviceId&&!o?(a().catch((function(){return c(!0)})),E.a.createElement("div",null)):E.a.createElement(Ke.d,null,E.a.createElement(Ke.b,{path:"/login"},t.email?E.a.createElement(Ke.a,{to:"/"}):E.a.createElement(ua,null)),E.a.createElement(Ke.b,{path:"/verify"},t.email?E.a.createElement(ua,null):E.a.createElement(Ke.a,{to:"/login"})),E.a.createElement(Ke.b,{path:"/"},t.email?t.emailVerify.verified?E.a.createElement(ua,null):E.a.createElement(Ke.a,{to:"/verify"}):E.a.createElement(Ke.a,{to:"/login"})))})),pa=a(17),Ea=a(197),fa=a(25);var va=function(e){var t=e.content,a=e.time,n=e.autohide,r=e.onClick,o=Object(p.useState)(!0),c=Object(We.a)(o,2),i=c[0],s=c[1],l=Object(p.useState)(!1),u=Object(We.a)(l,2),m=u[0],d=u[1],f=Object(p.useState)(Date.now()),v=Object(We.a)(f,1)[0]-a.getTime(),h=ut.string.milisecondsToTimeString(v),N=v<5e3?h:"".concat(h," ago");return E.a.createElement(Ea.a,{onClick:function(){s(!1),fa.a.isFunction(r)&&r()},onClose:function(){s(!1),fa.a.isFunction(r)&&r()},onMouseEnter:function(){d(!0)},onMouseLeave:function(){d(!1)},show:i,style:{cursor:"pointer"},delay:fa.a.isNumber(n)?n:4e3,autohide:!m},E.a.createElement(Ea.a.Body,null,E.a.createElement("div",null,t),E.a.createElement("small",null,N)))},ha=function(e){Object(O.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(h.a)(this,a),(n=t.call(this,e)).state={elements:[]},n}return Object(N.a)(a,[{key:"shouldComponentUpdate",value:function(e){if(e.app.toast&&e.app.notification){var t=e.app.toast,a=t.content,n=t.time,r=t.onClick,o=t.autohide,c=this.state.elements;if(e.app.sound)new Audio("./src/mp3/notification.mp3").play();return this.setState({elements:[].concat(Object(pa.a)(c),[E.a.createElement(va,{content:a,time:n,onClick:r,autohide:o,key:c.length})])}),this.props.pushToast(void 0),!1}return!0}},{key:"render",value:function(){return E.a.createElement("div",{className:"toast_contain"},this.state.elements)}}]),a}(p.Component),Na={pushToast:Be},Oa=Object(b.b)((function(e){return{app:e.app}}),Na)(ha),ga=a(194);var ba={closePopup:Qe},Ta=Object(b.b)((function(e){return{app:e.app}}),ba)((function(e){var t,a,n,r,o=e.app,c=e.closePopup,i=o.popup,s=i.show,l=i.body,u=i.header,m=i.openRecent;return l||(s=!1),E.a.createElement(ga.a,{show:s,onHide:function(){c(m)},dialogClassName:"popup",centered:!0},E.a.createElement(ga.a.Body,null,u?E.a.createElement("div",{className:"popup-header px-1"},E.a.createElement(Et.a,{variant:"link text-16",onClick:function(){var e;u&&"function"===typeof(null===u||void 0===u||null===(e=u.btnLeft)||void 0===e?void 0:e.func)&&u.btnLeft.func(),c(m)},style:{visibility:(null===u||void 0===u?void 0:u.btnLeft)?"visible":"hidden"}},(null===u||void 0===u||null===(t=u.btnLeft)||void 0===t?void 0:t.title)?null===u||void 0===u||null===(a=u.btnLeft)||void 0===a?void 0:a.title:"Cancel"),E.a.createElement("div",{className:"title text-16"},u.title),E.a.createElement(Et.a,{variant:"link text-16",onClick:function(){var e;u&&"function"===typeof(null===u||void 0===u||null===(e=u.btnRight)||void 0===e?void 0:e.func)&&u.btnRight.func(),c(m)},style:{visibility:(null===u||void 0===u?void 0:u.btnRight)?"visible":"hidden"}},(null===u||void 0===u||null===(n=u.btnRight)||void 0===n?void 0:n.title)?null===u||void 0===u||null===(r=u.btnRight)||void 0===r?void 0:r.title:"Done")):E.a.createElement(E.a.Fragment,null),E.a.createElement("div",{className:"popup-content"},l)))}));var Ra=Object(b.b)((function(e){return{app:e.app}}),{closeDialog:function(){return{type:fe.action.CLOSE_DIALOG,payload:void 0}}})((function(e){var t,a,n,r=e.app,o=e.closeDialog;return E.a.createElement("div",{className:"drop_contain ".concat(r.dropdown?"d-block":"d-none"),onClick:function(){o()}},E.a.createElement("div",{className:"drop_wrap",style:{top:"".concat((null===(t=r.dropdown)||void 0===t?void 0:t.position.y)||0,"px"),left:"".concat((null===(a=r.dropdown)||void 0===a?void 0:a.position.x)||0,"px")}},null===(n=r.dropdown)||void 0===n?void 0:n.content))})),Sa=void 0,ya=function(e){Object(O.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(h.a)(this,a),(n=t.call(this,e)).state={update:0},n}return Object(N.a)(a,[{key:"UNSAFE_componentWillMount",value:function(){var e=this;!function(){var e=localStorage.getItem("socketcluster.authToken");e&&(Ce=Object.assign(Ce,{authorization:"Bearer ".concat(e)}))}(),this.props.initialize(),this.props.setAppViewType(window.innerWidth<=575.98?m.MOBILE:m.WINDOW),window.addEventListener("resize",(function(t){window.addEventListener("resize",(function(){Sa&&(clearTimeout(Sa),Sa=void 0),Sa=setTimeout((function(){var a;Sa&&(clearTimeout(Sa),Sa=void 0);var n=(null===(a=t.target)||void 0===a?void 0:a.innerWidth)<=575.98?m.MOBILE:m.WINDOW;e.props.app.viewType!==n&&e.props.setAppViewType(n)}),100)}))}))}},{key:"render",value:function(){return E.a.createElement(E.a.Fragment,null,E.a.createElement(da,null),E.a.createElement(Ra,null),E.a.createElement(Ta,null),E.a.createElement(Oa,null))}}]),a}(p.Component),Ca={initialize:function(){var e=localStorage.getItem("deviceId");e||(e=Object(ve.a)(),localStorage.setItem("deviceId",e));var t=localStorage.getItem("lang");t||(t="en",localStorage.setItem("lang",t));var a=localStorage.getItem("sound"),n=!a||JSON.parse(a);a||(n=!0,localStorage.setItem("sound",JSON.stringify(n)));var r=localStorage.getItem("notification"),o=!r||JSON.parse(r);return r||(o=!0,localStorage.setItem("notification",JSON.stringify(o))),_e({deviceId:e}),_e({"accept-language":t}),{type:fe.action.INITIALIZE,payload:{initialized:!0,deviceId:e,lang:t,sound:n,notification:o}}},setAppViewType:function(e){return{type:fe.action.SET_VIEW_TYPE,payload:e}}},_a=Object(b.b)((function(e){return{app:e.app}}),Ca)(ya),Ia=a(39),ka=a(98),Aa={_id:"",email:"",emailVerify:{verified:!1}},wa={lang:"en",deviceId:"",viewType:m.WINDOW,unreadChatroom:!1,notification:!0,sound:!0,toast:void 0,popup:{}},xa={contentTab:l.CONVERSATION,peopleTab:u.PEOPLE,conversationView:d.NORMAL},Da=[],Pa={receive:[],sent:[]},Fa=[],ja={},Ua={},La=Object(Ia.c)({user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Aa,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case fe.action.LOGIN:case fe.action.REGISTER:case fe.action.TOKEN:case fe.action.UPDATE_USER_DATA:return Object.assign({},e,t.payload);case fe.action.CLEAN_USER_DATA:return{_id:"",email:"",emailVerify:{verified:!1}};case fe.action.VERIFY:return Object.assign({},e,{emailVerify:{verified:!0}});case fe.action.LOGOUT:return Object.assign({},e,{email:""});default:return e}},app:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:wa,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case fe.action.INITIALIZE:return Object.assign({},e,t.payload);case fe.action.SET_VIEW_TYPE:return Object.assign({},e,{viewType:t.payload});case fe.action.SET_UNREAD_STATE:return Object.assign({},e,{unreadChatroom:t.payload});case fe.action.PUSH_TOAST:return Object.assign({},e,{toast:t.payload});case fe.action.TOGGLE_SOUND:return Object.assign({},e,{sound:t.payload});case fe.action.TOGGLE_NOTIFICATION:return Object.assign({},e,{notification:t.payload});case fe.action.CLOSE_POPUP:return Object.assign({},e,{popup:t.payload&&e.popupBackup?Object.assign({},e.popupBackup):Object.assign({},e.popup,{show:!1})});case fe.action.OPEN_POPUP:return Object.assign({},e,{popup:Object.assign(t.payload,{show:!0}),popupBackup:Object.assign({},e.popup,{show:!0})});case fe.action.CLOSE_DIALOG:return Object.assign({},e,{dropdown:void 0});case fe.action.OPEN_DIALOG:return Object.assign({},e,{dropdown:t.payload});default:return e}},navigation:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xa,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case fe.action.CHOOSE_CONTENT_TAB:return Object.values(l).includes(t.payload)?Object.assign({},e,{contentTab:t.payload}):e;case fe.action.CHOOSE_PEOPLE_TAB:return Object.values(u).includes(t.payload)?Object.assign({},e,{peopleTab:t.payload}):e;case fe.action.NAVIGATOR_SET_CHATROOM:return Object.assign({},e,{chatroom:t.payload});case fe.action.SET_CONVERSATION_VIEW:return Object.assign({},e,{conversationView:t.payload});default:return e}},friend:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Da,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;if(a===fe.action.FRIEND_GET)return fa.a.isArray(n)?n:[];if(a===fe.action.FRIEND_PUSH)return[n].concat(Object(pa.a)(e));if(a===fe.action.FRIEND_POP){var r=Object(pa.a)(e),o=r.findIndex((function(e){return e._id===n._id}));if(fa.a.isNumber(o)&&-1!==o)return r.splice(o,1),r}else if(a===fe.action.FRIEND_SETNICKNAME){var c=Object(pa.a)(e),i=c.find((function(e){return e._id===n.friendId}));if(i&&fa.a.isString(n.nickname))return i.nickname=n.nickname,c}else if(a===fe.action.FRIEND_UPDATE_DATA){var s=Object(pa.a)(e),l=s.findIndex((function(e){return e._id===n._id}));if(fa.a.isNumber(l)&&-1!==l)return s.splice(l,1,n),s}return e},friendRequest:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Pa,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;if(a===fe.action.FRIENDREQUEST_GET)return fa.a.isEqual(fa.a.allKeys(n),["receive","sent"])?n:e;if(a===fe.action.FRIENDREQUEST_PUSH_RECEVICE){if(n)return Object.assign({},e,{receive:[].concat(Object(pa.a)(e.receive),[n])})}else if(a===fe.action.FRIENDREQUEST_PUSH_SENT){if(n)return Object.assign({},e,{sent:[].concat(Object(pa.a)(e.sent),[n])})}else if(a===fe.action.FRIENDREQUEST_POP_RECEVICE){if(n){var r=Object.assign({},e),o=r.receive.findIndex((function(e){return e._id===n._id}));if(fa.a.isNumber(o)&&-1!==o)return r.receive.splice(o,1),r}}else if(a===fe.action.FRIENDREQUEST_POP_SENT&&n){var c=Object.assign({},e),i=c.sent.findIndex((function(e){return e._id===n._id}));if(fa.a.isNumber(i)&&-1!==i)return c.sent.splice(i,1),c}return e},chatroom:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fa,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;if(a===fe.action.CHATROOM_CREATE){var r=n;if(e.every((function(e){return e.chatroom._id!==r.chatroom._id})))return[n].concat(Object(pa.a)(e))}else{if(a===fe.action.CHATROOM_UPDATE){var o=Object(pa.a)(e),c=n,i=e.findIndex((function(e){return e.chatroom._id===c.chatroom._id}));return"number"===typeof i&&-1!==i?(o.splice(i,1,c),o.sort((function(e,t){return new Date(t.chatroom.updateTime).getTime()-new Date(e.chatroom.updateTime).getTime()}))):[n].concat(Object(pa.a)(o))}if(a===fe.action.CHATROOM_UNFOLLOW){var s=Object(pa.a)(e),l=n,u=e.findIndex((function(e){return e.chatroom._id===l.chatroom._id}));if("number"===typeof u&&-1!==u)return s.splice(u,1),s;if(l)return[l].concat(Object(pa.a)(s))}else if(a===fe.action.CHATROOM_INVITE);else if(a===fe.action.CHATROOM_GETALLUSERCHATROOMS){var m=[].concat(Object(pa.a)(n),Object(pa.a)(e)),d=Array.from(new Set(m.map((function(e){return e.chatroom._id})))),p=d.map((function(e){return m.find((function(t){return t.chatroom._id===e}))})).sort((function(e,t){var a,n;return new Date(null===t||void 0===t||null===(a=t.chatroom)||void 0===a?void 0:a.updateTime).getTime()-new Date(null===e||void 0===e||null===(n=e.chatroom)||void 0===n?void 0:n.updateTime).getTime()}));return p}}return e},message:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ja,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;if(a===fe.action.MESSAGE_RECEIVE){var r=Object.assign({},e),o=n;return r[o.chatroom]=r[o.chatroom]||[],r[o.chatroom].unshift(o),r}if(a===fe.action.MESSAGE_GET){var c=Object.assign({},e),i=n.chatroomId,s=n.messages;return c[i]=c[i]||[],c[i]=s.concat(c[i]),c[i]=c[i].filter((function(e,t){return c[i].findIndex((function(t){return t._id===e._id}))===t})).sort((function(e,t){return new Date(t.createdTime).getTime()-new Date(e.createdTime).getTime()})),c}return e},typing:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ua,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;if(a===fe.action.TYPING){var r=n.chatroomId,o=n.typing,c=n.user,i=Object.assign({},e);i[r]=i[r]||[];var s=i[r];if(o)s.every((function(e){return e._id!==c._id}))&&s.push(c);else{var l=s.findIndex((function(e){return e._id===c._id}));-1!==l&&s.splice(l,1)}return i}return e}}),Ma=Object(Ia.d)(La,Object(Ia.a)(ka.a));Ma.subscribe((function(){return console.log("%cStore","color: #1e88e5",Ma.getState())}));var Ga=Ma,Ha=(a(178),a(179),a(180),a(76)),Va=a(193),Ba=a(99),Qa=a(104);Ha.a.use(Ba.a).use(Qa.a).use(Va.a).init({fallbackLng:"en",interpolation:{escapeValue:!1}});Ha.a;var qa=function(){return E.a.createElement(p.Suspense,{fallback:"loading"},E.a.createElement(b.a,{store:Ga},E.a.createElement(ca.a,null,E.a.createElement(_a,null))))};v.a.render(E.a.createElement(qa,null),document.getElementById("root"))}},[[107,1,2]]]);
//# sourceMappingURL=main.8eba4b06.chunk.js.map